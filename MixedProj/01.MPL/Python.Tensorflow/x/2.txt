
for a in /sys/bus/pci/devices/*; do echo 0 | sudo tee -a $a/numa_node; done
tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
export TF_XLA_FLAGS=--tf_xla_enable_xla_devices

tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 

pciBusID: 0000:06:00.0 name: NVIDIA GeForce RTX 4070 computeCapability: 8.9
coreClock: 2.475GHz coreCount: 46 deviceMemorySize: 11.60GiB deviceMemoryBandwidth: 469.43GiB/s
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
tensorflow/core/platform/cpu_feature_guard.cc:142] 
	This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) 
	to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA

To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3094185000 Hz
tensorflow/compiler/xla/service/service.cc:168] XLA service 0x31b41390 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
tensorflow/compiler/xla/service/service.cc:168] XLA service 0x31cec4b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070, Compute Capability 8.9
tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
	pciBusID: 0000:06:00.0 name: NVIDIA GeForce RTX 4070 computeCapability: 8.9
	coreClock: 2.475GHz coreCount: 46 deviceMemorySize: 11.60GiB deviceMemoryBandwidth: 469.43GiB/s

tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2025-09-20 16:02:12.912755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2025-09-20 16:02:12.912780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2025-09-20 16:02:12.912803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2025-09-20 16:02:12.912826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2025-09-20 16:02:12.912849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2025-09-20 16:02:12.912872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2025-09-20 16:02:12.912894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2025-09-20 16:02:12.916558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2025-09-20 16:02:12.917193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2025-09-20 16:02:16.244470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2025-09-20 16:02:16.244513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2025-09-20 16:02:16.244524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2025-09-20 16:02:16.247965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 10546 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:06:00.0, compute capability: 8.9)
2025-09-20 16:02:16.601297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: NVIDIA GeForce RTX 4070 computeCapability: 8.9
coreClock: 2.475GHz coreCount: 46 deviceMemorySize: 11.60GiB deviceMemoryBandwidth: 469.43GiB/s
2025-09-20 16:02:16.601336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2025-09-20 16:02:16.601359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2025-09-20 16:02:16.601371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2025-09-20 16:02:16.601382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2025-09-20 16:02:16.601393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2025-09-20 16:02:16.601404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2025-09-20 16:02:16.601415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2025-09-20 16:02:16.601425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2025-09-20 16:02:16.603478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2025-09-20 16:02:16.603509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2025-09-20 16:02:16.603517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2025-09-20 16:02:16.603524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2025-09-20 16:02:16.605867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10546 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:06:00.0, compute capability: 8.9)
2025-09-20 16:02:16.916057: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2025-09-20 16:02:17.405654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10

