<!DOCTYPE html>
<!-- saved from url=(0082)https://medium.com/data-science/creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada -->
<html lang="en" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="origin-trial" content="A7vZI3v+Gz7JfuRolKNM4Aff6zaGuT7X0mf3wtoZTnKv6497cVMnhy03KDqX7kBz/q/iidW7srW31oQbBt4VhgoAAACUeyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGUuY29tOjQ0MyIsImZlYXR1cmUiOiJEaXNhYmxlVGhpcmRQYXJ0eVN0b3JhZ2VQYXJ0aXRpb25pbmczIiwiZXhwaXJ5IjoxNzU3OTgwODAwLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><title>Creating a TensorFlow CNN in C++ (Part 2) | by Benny Friedman | TDS Archive | Medium</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236, app-argument=/data-science/creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada, affiliate-data=pt=698524&amp;ct=smart_app_banner&amp;mt=8"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-06-10T22:20:29.810Z"><meta data-rh="true" name="title" content="Creating a TensorFlow CNN in C++ (Part 2) | by Benny Friedman | TDS Archive | Medium"><meta data-rh="true" property="og:title" content="Creating a TensorFlow CNN in C++ (Part 2)"><meta data-rh="true" property="al:android:url" content="medium://p/eea0de9dcada"><meta data-rh="true" property="al:ios:url" content="medium://p/eea0de9dcada"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="In the last two years, Google’s TensorFlow has been gaining popularity. It is by far the most popular deep learning framework and together with Keras it is the most dominant framework. However, when…"><meta data-rh="true" property="og:description" content="In this post I’ll show how to create, train and test a Convolutional Neural Network using the TensorFlow C++ API"><meta data-rh="true" property="og:url" content="https://medium.com/data-science/creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada"><meta data-rh="true" property="al:web:url" content="https://medium.com/data-science/creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*R6INLxmJU9ALePGUAYuMNQ.png"><meta data-rh="true" property="article:author" content="https://medium.com/@bennyfriedman"><meta data-rh="true" name="author" content="Benny Friedman"><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Creating a TensorFlow CNN in C++ (Part 2)"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/eea0de9dcada"><meta data-rh="true" property="twitter:description" content="In this post I’ll show how to create, train and test a Convolutional Neural Network using the TensorFlow C++ API"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*R6INLxmJU9ALePGUAYuMNQ.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="13 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com/" crossorigin=""><link data-rh="true" rel="manifest" href="https://medium.com/manifest.json"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@bennyfriedman"><link data-rh="true" rel="canonical" href="https://medium.com/data-science/creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/eea0de9dcada"><style type="text/css" data-fela-rehydration="576" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="576" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.d{display:none}.m{display:block}.n{position:sticky}.o{top:0}.p{z-index:500}.q{padding:0 24px}.r{align-items:center}.s{border-bottom:solid 1px #F2F2F2}.z{height:41px}.ab{line-height:20px}.ac{display:flex}.ae{height:57px}.af{flex:1 0 auto}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:none}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{margin-left:24px}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{flex:1 1 auto}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(102, 138, 170, 1)}.es{border-color:rgba(102, 138, 170, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(102, 138, 170, 1)}.ez:disabled:hover{border-color:rgba(102, 138, 170, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fg{margin-left:16px}.fh{border:inherit}.fk{margin-right:32px}.fl{position:relative}.fm{fill:#6B6B6B}.fp{background:transparent}.fq svg{margin-left:4px}.fr svg{fill:#6B6B6B}.ft{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fu{position:absolute}.fw{max-width:100%}.fx{overflow:hidden}.fy{text-overflow:ellipsis}.fz{white-space:nowrap}.ga{border-bottom:1px solid #F2F2F2}.gb{height:3px}.gc{background-color:rgba(102, 138, 170, 1)}.gd{max-width:1192px}.gj{font-weight:500}.gx{margin:0 8px}.gy{display:inline}.gz{font-size:16px}.ha{line-height:24px}.hb{pointer-events:none}.hc{will-change:opacity, transform}.hd{width:calc(100% - 0px)}.hg{opacity:0}.hh{transform:translateY(89px)}.hi{width:148px}.hj{border-radius:2px}.hk{height:38px}.hl{width:38px}.hn{margin-top:16px}.ho{word-break:break-word}.hu{margin:0 24px}.hy{background:rgba(255, 255, 255, 1)}.hz{border:1px solid #F2F2F2}.ia{box-shadow:0 1px 4px #F2F2F2}.ib{max-height:100vh}.ic{overflow-y:auto}.id{left:0}.ie{top:calc(100vh + 100px)}.if{bottom:calc(100vh + 100px)}.ig{width:10px}.ih{word-wrap:break-word}.ii:after{display:block}.ij:after{content:""}.ik:after{clear:both}.il{line-height:1.23}.im{letter-spacing:0}.in{font-style:normal}.io{font-weight:700}.jj{margin-bottom:-0.27em}.jk{line-height:1.394}.ka{font-style:inherit}.kl{gap:12px}.km{align-items:baseline}.kn{width:36px}.ko{height:36px}.kp{border:2px solid rgba(255, 255, 255, 1)}.kq{z-index:0}.kr{box-shadow:none}.ks{border:1px solid rgba(0, 0, 0, 0.05)}.kt{margin-bottom:2px}.ku{flex-wrap:nowrap}.kw{width:12px}.kx{flex-wrap:wrap}.ky{padding-left:8px}.kz{padding-right:8px}.ma> *{flex-shrink:0}.mb{overflow-x:scroll}.mc::-webkit-scrollbar{display:none}.md{scrollbar-width:none}.me{-ms-overflow-style:none}.mf{width:74px}.mg{flex-direction:row}.mh{z-index:2}.mi{margin-right:4px}.ml{-webkit-user-select:none}.mm{border:0}.mn{fill:rgba(117, 117, 117, 1)}.mq{outline:0}.mr{user-select:none}.ms> svg{pointer-events:none}.nb{cursor:progress}.nc{margin-left:4px}.nd{margin-top:0px}.ne{opacity:1}.nf{padding:4px 0}.ni{width:16px}.nk{display:inline-flex}.nq{padding:8px 2px}.nr svg{color:#6B6B6B}.oi{line-height:1.12}.oj{letter-spacing:-0.022em}.ok{font-weight:600}.pb{margin-bottom:-0.28em}.pc{line-height:1.58}.pd{letter-spacing:-0.004em}.pe{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.pu{margin-bottom:-0.46em}.pv{text-decoration:underline}.qb{line-height:1.18}.qh{margin-bottom:-0.31em}.qn{overflow-x:auto}.qo{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qp{padding:20px}.qq{border-radius:0}.qr{background:#F2F2F2}.qs{margin-top:-0.09em}.qt{margin-bottom:-0.09em}.qu{white-space:pre-wrap}.qv{min-width:fit-content}.qw{margin-top:0.91em}.qx{margin-left:auto}.qy{margin-right:auto}.qz{max-width:1335px}.ra{clear:both}.rc{cursor:zoom-in}.rd{z-index:auto}.rf{height:auto}.rg{margin-top:10px}.rh{max-width:728px}.rp{max-width:6165px}.rq{padding-top:5px}.rr{padding-bottom:5px}.rs{margin-bottom:26px}.rt{margin-top:6px}.ru{margin-top:8px}.rv{margin-right:8px}.rw{padding:8px 16px}.rx{border-radius:100px}.ry{transition:background 300ms ease}.sa{border-top:none}.sb{margin-bottom:50px}.sc{height:52px}.sd{max-height:52px}.se{box-sizing:content-box}.sf{position:static}.sg{z-index:1}.si{max-width:155px}.so{margin-right:20px}.sp{flex:0 0 auto}.sq{margin-bottom:64px}.sr{margin-bottom:48px}.te{height:48px}.tf{width:48px}.tg{height:64px}.th{width:64px}.ti{align-self:flex-end}.tm{padding-right:4px}.ty{height:0px}.tz{gap:18px}.ua{fill:rgba(61, 61, 61, 1)}.uc{padding-bottom:20px}.ui{margin-top:32px}.uj{fill:#242424}.uk{background:0}.ul{border-color:#242424}.un:disabled:hover{color:#242424}.uo:disabled:hover{fill:#242424}.up:disabled:hover{border-color:#242424}.va{border-bottom:solid 1px #E5E5E5}.vb{margin-top:72px}.vc{padding:24px 0}.vd{margin-bottom:0px}.ve{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(90, 118, 144, 1)}.eu:hover{border-color:rgba(90, 118, 144, 1)}.ev:hover{cursor:pointer}.fn:hover{color:#242424}.fo:hover{fill:#242424}.fs:hover svg{fill:#242424}.fv:hover{background-color:rgba(0, 0, 0, 0.1)}.hm:hover{background-color:none}.kv:hover{text-decoration:underline}.mp:hover{fill:rgba(8, 8, 8, 1)}.ng:hover{fill:#000000}.nh:hover p{color:#000000}.nj:hover{color:#000000}.ns:hover svg{color:#000000}.rz:hover{background-color:#F2F2F2}.ub:hover{fill:rgba(25, 25, 25, 1)}.um:hover{border-color:#242424}.bd:focus-within path{fill:#242424}.mo:focus{fill:rgba(8, 8, 8, 1)}.nt:focus svg{color:#000000}.re:focus{transform:scale(1.01)}.mt:active{border-style:none}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (min-width: 1080px)">.e{display:none}.bv{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fj{display:flex}.gi{max-width:250px}.gu{font-size:20px}.gv{line-height:24px}.gw{letter-spacing:0}.ht{margin-bottom:50px}.hx{max-width:680px}.jf{font-size:42px}.jg{margin-top:1.19em}.jh{line-height:52px}.ji{letter-spacing:-0.011em}.jx{font-size:22px}.jy{margin-top:0.92em}.jz{line-height:28px}.kj{align-items:center}.kk{flex-direction:row}.lm{border-top:solid 1px #F2F2F2}.ln{border-bottom:solid 1px #F2F2F2}.lo{margin:32px 0 0}.lp{padding:3px 8px}.ly> *{margin-right:24px}.lz> :last-child{margin-right:0}.na{margin-top:0px}.np{margin:0}.ox{font-size:24px}.oy{margin-top:1.95em}.oz{line-height:30px}.pa{letter-spacing:-0.016em}.pr{margin-top:0.94em}.ps{line-height:32px}.pt{letter-spacing:-0.003em}.qa{margin-top:2.14em}.qg{margin-top:1.72em}.qm{margin-top:56px}.ro{max-width:1192px}.sn{display:inline-block}.su{margin-bottom:0}.sv{margin-right:20px}.tj{max-width:500px}.tx{margin-bottom:88px}.uh{margin:40px 0 16px}.uu{width:min-width}.uz{padding-top:72px}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.f{display:none}.mz{margin-top:0px}.ri{margin-left:auto}.rj{text-align:center}.sm{display:inline-block}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (max-width: 903.98px)">.g{display:none}.my{margin-top:0px}.sl{display:inline-block}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (max-width: 727.98px)">.h{display:none}.mw{margin-top:0px}.mx{margin-right:0px}.sk{display:inline-block}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (max-width: 551.98px)">.i{display:none}.t{display:flex}.u{justify-content:space-between}.br{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.ge{max-width:150px}.gk{font-size:16px}.gl{letter-spacing:0}.hp{margin-bottom:2px}.ip{font-size:32px}.iq{margin-top:1.01em}.ir{line-height:38px}.is{letter-spacing:-0.014em}.jl{font-size:18px}.jm{margin-top:0.79em}.jn{line-height:24px}.kb{align-items:flex-start}.kc{flex-direction:column-reverse}.la{margin:24px -24px 0}.lb{padding:0}.lq> *{margin-right:8px}.lr> :last-child{margin-right:24px}.mj{margin-left:0px}.mu{margin-top:0px}.mv{margin-right:0px}.nl{margin:0}.nu{border:1px solid #F2F2F2}.nv{border-radius:99em}.nw{padding:0px 16px 0px 12px}.nx{height:38px}.ny{align-items:center}.oa svg{margin-right:8px}.ol{font-size:20px}.om{margin-top:1.2em}.pf{margin-top:0.67em}.pg{line-height:28px}.ph{letter-spacing:-0.003em}.pw{margin-top:1.56em}.qc{margin-top:1.23em}.qi{margin-top:40px}.rk{max-width:100%}.sj{display:inline-block}.st{flex-direction:column}.tc{margin-bottom:20px}.td{margin-right:0}.tn{font-size:24px}.to{line-height:30px}.tp{letter-spacing:-0.016em}.tt{margin-bottom:64px}.ud{margin:32px 0 16px}.uq{width:100%}.uv{padding-top:48px}.nz:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.bu{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fi{display:flex}.gh{max-width:250px}.gr{font-size:20px}.gs{line-height:24px}.gt{letter-spacing:0}.hs{margin-bottom:50px}.hw{max-width:680px}.jb{font-size:42px}.jc{margin-top:1.19em}.jd{line-height:52px}.je{letter-spacing:-0.011em}.ju{font-size:22px}.jv{margin-top:0.92em}.jw{line-height:28px}.kh{align-items:center}.ki{flex-direction:row}.li{border-top:solid 1px #F2F2F2}.lj{border-bottom:solid 1px #F2F2F2}.lk{margin:32px 0 0}.ll{padding:3px 8px}.lw> *{margin-right:24px}.lx> :last-child{margin-right:0}.no{margin:0}.ot{font-size:24px}.ou{margin-top:1.95em}.ov{line-height:30px}.ow{letter-spacing:-0.016em}.po{margin-top:0.94em}.pp{line-height:32px}.pq{letter-spacing:-0.003em}.pz{margin-top:2.14em}.qf{margin-top:1.72em}.ql{margin-top:56px}.rn{max-width:1192px}.sw{margin-bottom:0}.sx{margin-right:20px}.tk{max-width:500px}.tw{margin-bottom:88px}.ug{margin:40px 0 16px}.ut{width:min-width}.uy{padding-top:72px}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.x{display:flex}.y{justify-content:space-between}.bt{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.gg{max-width:250px}.go{font-size:20px}.gp{line-height:24px}.gq{letter-spacing:0}.hr{margin-bottom:50px}.hv{max-width:680px}.ix{font-size:42px}.iy{margin-top:1.19em}.iz{line-height:52px}.ja{letter-spacing:-0.011em}.jr{font-size:22px}.js{margin-top:0.92em}.jt{line-height:28px}.kf{align-items:center}.kg{flex-direction:row}.le{border-top:solid 1px #F2F2F2}.lf{border-bottom:solid 1px #F2F2F2}.lg{margin:32px 0 0}.lh{padding:3px 8px}.lu> *{margin-right:24px}.lv> :last-child{margin-right:0}.nn{margin:0}.op{font-size:24px}.oq{margin-top:1.95em}.or{line-height:30px}.os{letter-spacing:-0.016em}.pl{margin-top:0.94em}.pm{line-height:32px}.pn{letter-spacing:-0.003em}.py{margin-top:2.14em}.qe{margin-top:1.72em}.qk{margin-top:56px}.rm{max-width:100%}.sy{margin-bottom:0}.sz{margin-right:20px}.tl{max-width:500px}.tv{margin-bottom:88px}.uf{margin:40px 0 16px}.us{width:min-width}.ux{padding-top:72px}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.v{display:flex}.w{justify-content:space-between}.bs{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.gf{max-width:150px}.gm{font-size:16px}.gn{letter-spacing:0}.hq{margin-bottom:2px}.it{font-size:32px}.iu{margin-top:1.01em}.iv{line-height:38px}.iw{letter-spacing:-0.014em}.jo{font-size:18px}.jp{margin-top:0.79em}.jq{line-height:24px}.kd{align-items:flex-start}.ke{flex-direction:column-reverse}.lc{margin:24px 0 0}.ld{padding:0}.ls> *{margin-right:8px}.lt> :last-child{margin-right:8px}.mk{margin-left:0px}.nm{margin:0}.ob{border:1px solid #F2F2F2}.oc{border-radius:99em}.od{padding:0px 16px 0px 12px}.oe{height:38px}.of{align-items:center}.oh svg{margin-right:8px}.on{font-size:20px}.oo{margin-top:1.2em}.pi{margin-top:0.67em}.pj{line-height:28px}.pk{letter-spacing:-0.003em}.px{margin-top:1.56em}.qd{margin-top:1.23em}.qj{margin-top:40px}.rl{max-width:100%}.ss{flex-direction:column}.ta{margin-bottom:20px}.tb{margin-right:0}.tq{font-size:24px}.tr{line-height:30px}.ts{letter-spacing:-0.016em}.tu{margin-bottom:64px}.ue{margin:32px 0 16px}.ur{width:100%}.uw{padding-top:48px}.og:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="print">.sh{display:none}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.he{transition:opacity 200ms}.rb{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="576" data-fela-type="RULE" media="all and (max-width: 1232px)">.hf{display:none}</style><script type="text/javascript" async="" charset="utf-8" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/recaptcha__pl.js.pobrane" crossorigin="anonymous" integrity="sha384-Bo53U7fPcCaxzx3Fg0Ghiq6fv+Pl5t0geuZuZ3BKKoErhx0r/17nJ+GKXw1gfZh4"></script><script async="" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/branch-latest.min.js.pobrane"></script><style data-fela-type="RULE" type="text/css" media="(orientation: landscape) and (max-width: 903.98px)"></style><link rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:203:203/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:160:160/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:101:101/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:80:80/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156" data-rh="true"><link rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:667:667/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*R6INLxmJU9ALePGUAYuMNQ.png"],"url":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada","dateCreated":"2019-06-10T20:30:43.474Z","datePublished":"2019-06-10T20:30:43.474Z","dateModified":"2021-12-10T10:48:23.065Z","headline":"Creating a TensorFlow CNN in C++ (Part 2) - TDS Archive - Medium","name":"Creating a TensorFlow CNN in C++ (Part 2) - TDS Archive - Medium","description":"In the last two years, Google’s TensorFlow has been gaining popularity. It is by far the most popular deep learning framework and together with Keras it is the most dominant framework. However, when…","identifier":"eea0de9dcada","author":{"@type":"Person","name":"Benny Friedman","url":"https:\u002F\u002Fmedium.com\u002F@bennyfriedman"},"creator":["Benny Friedman"],"publisher":{"@type":"Organization","name":"TDS Archive","url":"https:\u002F\u002Fmedium.com\u002Fdata-science","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:363\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada"}</script><script async="true" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/js" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');
            gtag('config', 'AW-17106321204');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener banner closeBanner closeJourney data deepview deepviewCta first init link logout removeListener setBranchViewData setIdentity track trackCommerceEvent logEvent disableTracking getBrowserFingerprintId crossPlatformIds lastAttributedTouchData setAPIResponseCallback qrCode setRequestMetaData setAPIUrl getAPIUrl setDMAParamsForEEA".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/enterprise.js.pobrane" data-rh="true"></script><style id="googleidentityservice_button_styles">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-r4WDKb{height:42px;width:42px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:rgb(210,227,252);outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><link id="googleidentityservice" type="text/css" media="all" href="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/style" rel="stylesheet"><meta http-equiv="origin-trial" content="A8o5T4MyEkRZqLA9WeG2XTFdV5tsX2Prg85xyQ+RL1btVuybB1K/EQ+7JUsPK+J32oBMTnsoF9B4A+qTlL6efgQAAABweyJvcmlnaW4iOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkZlZENtQnV0dG9uTW9kZSIsImV4cGlyeSI6MTc0NDY3NTIwMCwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="></head><body><div id="root"><div class="a b c"><a href="https://medium.com/sitemap/sitemap.xml" class="d">Sitemap</a><div class="e f g h i j k l"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="m c"><div class="m n o p c" style="transform: translateY(0px);"><div class="q r s t u v w x y j e z ab"><a class="du ah dv bf al b an ao ap aq ar as at au t v x j e r dw ab" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feea0de9dcada&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;%7Estage=mobileNavBar&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="q r s ac ae"><div class="ac r af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ac" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" aria-labelledby="wordmark-medium-desc" viewBox="0 0 719 160" class="av aw ax"><desc id="wordmark-medium-desc">Medium Logo</desc><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ay i"><div class="ac aj az ba bb r bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ac"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="aj be bf bg ab bh bi bj bk bl" placeholder="Search" value=""></div></div></div><div class="i l x fi fj"><div class="fk ac"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" data-discover="true"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt m">Write</div></div></a></span></div></div><div class="l k j e"><div class="fk ac"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" rel="noopener follow" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" data-discover="true"><div class="bf b bg ab du fl fm ac r fn fo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fk i l k"><div class="ac r"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="fg m"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" rel="noopener follow" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" data-discover="true">Sign in</a></span></p></div></div></div><div class="m" aria-hidden="false"><button class="aj fp an ac r ap fl fq fr fs" aria-label="user options menu" data-testid="headerUserIcon"><div class="m fl"><img alt="" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="ft bx m by bz fu o aj fv"></div></div></button></div></div></div><div class="ac"><div class="sp" style="width: 0px;"></div><div class="ca bh" style="width: calc(100% + 0px);"><div class="m"><div><div class="ga bh m"><div class="gb bh gc"></div><div class="ac cb"><div class="cc cd ce cf cg gd ci bh"><div class="ae ac r"><div class="ge gf gg gh gi m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.com/data-science?source=post_page---publication_nav-7f60cf5620c9-eea0de9dcada---------------------------------------" rel="noopener follow"><h2 class="bf gj gk dy gl gm ea gn go gp gq gr gs gt gu gv gw bk"><div class="fw fx fy fz">TDS Archive</div></h2></a></div><div class="t v k j e"><span class="gx gy" aria-hidden="true"><span class="bf b gz ha bk">·</span></span><p class="bf b gz ha bk"><span><a class="ag ah ai fh ak al am an ao ap aq ar as pv" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fdata-science&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;collection=TDS+Archive&amp;collectionId=7f60cf5620c9&amp;source=post_page---publication_nav-7f60cf5620c9-eea0de9dcada---------------------publication_nav------------------" data-discover="true">Follow publication</a></span></p></div></div></div></div></div></div><div class="sh" role="dialog" aria-modal="true" tabindex="-1"><div class="vk vl bh dw vm vn vo ap hg hb vp" aria-hidden="true" role="presentation"></div><div class="vq vm vr vs vt vk dw fd vu vv vw ne vx vy vz wa wb wc wd we wf wg ac co wh" aria-hidden="true"><div class="wi ic"></div></div></div><div class="hb fu hc hd o he hf ne wj"><div class="ac cb"><div class="cc cd ce cf cg gd ci bh"><div class="hi m"><div class="wk"><div class="ac cn co"><a href="https://medium.com/data-science?source=post_page---post_publication_sidebar-7f60cf5620c9-eea0de9dcada---------------------------------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hj m hl hk" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_JEuS4KBdakUcjg9sC7Wo4A.png" width="38" height="38" loading="lazy"><div class="hj m hk hl fu o ft hm"></div></div></a><div class="hn m"></div><p class="bf b bg ab du"><span class="ho">An archive of data science, data analytics, data engineering, machine learning, and artificial intelligence writing from the former Towards Data Science Medium publication.</span></p><div class="hn m"></div><p class="bf b bg ab bk"><span><a class="ag ah ai fh ak al am an ao ap aq ar as pv" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fdata-science&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;collection=TDS+Archive&amp;collectionId=7f60cf5620c9&amp;source=post_page---post_publication_sidebar-7f60cf5620c9-eea0de9dcada---------------------post_publication_sidebar------------------" data-discover="true">Follow publication</a></span></p></div></div></div></div></div></div><div class="hp hq hr hs ht m"><div class="ac cb"><div class="ci bh hu hv hw hx"></div></div><article><div class="m"><div class="m"><span class="m"></span><section><div><div class="fu id wl if ig hb"></div><div class="ho ih ii ij ik"><div class="ac cb"><div class="ci bh hu hv hw hx"><div><h1 id="0fe6" class="pw-post-title il im in bf io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bk" data-testid="storyTitle" data-selectable-paragraph=""><strong class="am">Creating a TensorFlow CNN in C++ (Part 2)</strong></h1></div><div><h2 id="77c0" class="pw-subtitle-paragraph jk im in bf b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz cq du" data-selectable-paragraph=""><em class="ka">In this post I’ll show how to create, train and test a Convolutional Neural Network using the TensorFlow C++ API</em></h2><div><div class="speechify-ignore ac cp"><div class="speechify-ignore bh m"><div class="ac kb kc kd ke kf kg kh ki kj kk kl"><div class="ac r kl"><div class="ac km"><div><div class="bm" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div tabindex="-1" class="be"><a rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---byline--eea0de9dcada---------------------------------------" data-discover="true"><div class="m kn ko bx kp kq"><div class="m fl"><img alt="Benny Friedman" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2_-kLmQWFvXHMQAf6yZ88THA.png" width="32" height="32" loading="lazy" data-testid="authorPhoto"><div class="kr bx m by bz fu o ks fv"></div></div></div></a></div></div></div></div><span class="bf b bg ab bk"><div class="kt ac r"><div class="ac r ku"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><div tabindex="-1" class="be"><span class="bf b bg ab bk"><a class="ag ah ai fh ak al am an ao ap aq ar as kv" data-testid="authorName" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---byline--eea0de9dcada---------------------------------------" data-discover="true">Benny Friedman</a></span></div></div></div></div><div class="kw bm"></div><div class="bm" aria-hidden="false"><button class="uk yu ap ac cb r yv yw yx" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm yy">Follow</span></span></button></div></div></div></span></div><div class="ac r kx"><span class="bf b bg ab du"><div class="ac af"><span data-testid="storyReadTime">13 min read</span><div class="ky kz m" aria-hidden="true"><span class="m" aria-hidden="true"><span class="bf b bg ab du">·</span></span></div><span data-testid="storyPublishDate">Jun 10, 2019</span></div></span></div></div><div class="ac cp la lb lc ld le lf lg lh li lj lk ll lm ln lo lp"><div class="i l x fi fj r"><div class="mf m"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl mi mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdata-science%2Feea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;user=Benny+Friedman&amp;userId=cc3e73266fd9&amp;source=---header_actions--eea0de9dcada---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><div tabindex="-1" class="be"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><div><div class="bm" aria-hidden="false" aria-describedby="77" aria-labelledby="77"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au yz nj">142<span class="m i h g sm sn"></span></button></p></div></div></div></div></div></div><div><div class="bm" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><div tabindex="-1" class="be"><button class="ap mm ne nf ac r fm ng nh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nd"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du"><span class="pw-responses-count nc nd">4</span></p></button></div></div></div></div><div class="ac r lq lr ls lt lu lv lw lx ly lz ma mb mc md me"><div class="ni l k j e"></div><div class="i l"><div><div class="bm" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=---header_actions--eea0de9dcada---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="fd nk cn"><div class="m af"><div class="ac cb"><div class="nl nm nn no np fw ci bh"><div class="ac"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Deea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=---header_actions--eea0de9dcada---------------------post_audio_button------------------" data-discover="true"><div><div class="bm" aria-hidden="false" aria-describedby="49" aria-labelledby="49"><div tabindex="-1" class="be"><button aria-label="Listen" data-testid="audioPlayButton" class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt nu nv nw nx t ny nz oa ob oc od oe v of og oh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bf b bg ab du">Listen</p></div></button></div></div></div></a></span></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt nu nv nw nx t ny nz oa ob oc od oe v of og oh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="k j e"><p class="bf b bg ab du">Share</p></div></button></div></div></div></div></div></div></div></div></div></div><h1 id="5b1d" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Background</h1><p id="4411" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">In the last two years, Google’s TensorFlow has been gaining popularity. It is by far the most popular deep learning framework and together with Keras <a class="ag pv" href="https://towardsdatascience.com/deep-learning-framework-power-scores-2018-23607ddf297a" rel="noopener" target="_blank">it is the most dominant</a> framework.</p><p id="9814" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Now with version 2, TensorFlow includes Keras built it.</p><p id="6872" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">However, when it comes to the C++ API, you can’t really find much information about using it. Most of the code samples and documentation are in Python. As I had mentioned in my previous posts, I want to allow C++ users, such as myself, to use the TensorFlow C++ API, which is a low-level API, which practically means that you have to put in more work to implement it. My post is here to help you.</p><p id="c819" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">As I wrote in the past, I like C++. I have nothing against Python, but I would like to be able to build my models in C++ and also have the ecosystem of tools to help me debug and optimize it.</p><p id="2873" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I read the documentation, and looked for code samples that will show me how to create a convolutional neural network. There are a couple of them, <a class="ag pv" rel="noopener" href="https://medium.com/@htmbx6/build-and-train-neural-network-with-tensorflow-c-f13f22d3c5b6" data-discover="true">here</a> and <a class="ag pv" href="https://matrices.io/training-a-deep-neural-network-using-only-tensorflow-c/" rel="noopener ugc nofollow" target="_blank">here</a> which inspired me. That’s all!</p><p id="7e10" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I had to reverse engineer some of the APIs and went through a lot of trial and errors until it worked.</p><p id="3ccd" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I hope this article will serve others who would like to start using the C++ API.</p><p id="0d64" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I’m using XCode on MacOS, but I tried to build the code in a way that it will also work on Windows or Linux. I did not test that, so if you have any suggestions for a change, let me know.</p><h1 id="513f" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Setup</h1><p id="558f" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">I am assuming you already have TensorFlow installed, and you have an XCode project ready to use it. If you need help with that, please read and follow my instructions <a class="ag pv" href="https://itnext.io/how-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="7367" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">As I wrote in <a class="ag pv" href="https://itnext.io/creating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586" rel="noopener ugc nofollow" target="_blank">part 1</a>, the goal is to implement the AlexNet scaled-down version from part 4 of the famous article series by Arden Dertat.</p><p id="6954" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I’m also assuming you know the terminology of convolutional networks, if not, I suggest you read Arden’s articles.</p><p id="8b60" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To get the data for training, you will need to download the images from <a class="ag pv" href="https://www.kaggle.com/c/dogs-vs-cats" rel="noopener ugc nofollow" target="_blank">Kaggle</a>.</p><p id="3365" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Download the small version from <a class="ag pv" href="https://s3.amazonaws.com/img-datasets/cats_and_dogs_small.zip" rel="noopener ugc nofollow" target="_blank">here</a>. There are enough images there for our purpose.</p><p id="c807" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Extract the files and put them in a data folder under the project folder.</p><p id="c494" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">It should be organized so you have three sub-folders for train, validation and test.</p><h1 id="4218" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Code</h1><p id="1e63" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Code for this article can be found <a class="ag pv" href="https://github.com/bennyfri/TFMacCpp" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="710b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">There’s a main.cpp which drives the execution and two class files CatDogCNN.cpp and CatDogCNN.h which are the implementation of the network itself.</p><p id="e29e" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">mainV1.cpp is the previous article code.</p><p id="ebce" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">In general, when writing code for TensorFlow, it is wise to separate the creation of the graph from its actual running. This is due to the simple fact that you usually create the graph once and run it many times with different inputs. Even if you do not change the variables of the graph (like weights) there is no need to recreate the graph each time you want to run it, unless it is extremely simple, and the effort of separation is useless.</p><h1 id="ab17" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Complete the data preparation</h1><p id="b453" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">CreateGraphForImage is a method that creates a graph similar to the one I showed in <a class="ag pv" href="https://itnext.io/creating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586" rel="noopener ugc nofollow" target="_blank">part 1</a>.</p><p id="5c9f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">It accepts a Boolean whether to unstack the image. Call it with false when you want to load only one image and true when you want to load a batch. This is since an additional dimension will be added when stacking a batch. But when you want to run the CNN with only one image, you need to have all 4 dimensions.</p><p id="653f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note that when changing from unstack to stack you have to re-create the graph.</p><p id="b94b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">ReadTensorFromImageFile is in charge of running the graph created by the previous method. You feed it with a full path name of a file and get a 3 or 4 dimensional Tensor.</p><p id="2f64" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Code for both these methods is almost identical to the code in mainV1.cpp (article part 1).</p><h2 id="7c9f" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Handling folders and path</h2><p id="9642" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">ReadFileTensors deals with folders and the files. It accepts a base folder string and a vector of pairs of [sub-folder, label value].</p><p id="0d43" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">If you downloaded the images from Kaggle, you may have noticed that under train for example, there are two sub-folders cats and dogs. Label each one of them with a number and pass these pairs as input.</p><p id="02b9" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The return is a vector of pairs, each one is a Tensor (of an image) and a label.</p><p id="e7f6" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Here is one way of calling it:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="1b0a" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">base_folder = "/Users/bennyfriedman/Code/TF2example/TF2example/data/cats_and_dogs_small/train";</span><span id="3bf6" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">vector&lt;pair&lt;Tensor, float&gt;&gt; all_files_tensors;</span><span id="a7bb" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">model.ReadFileTensors(base_folder, {make_pair("cats", 0), make_pair("dogs", 1)}, all_files_tensors);</span></pre><p id="4918" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We need to open a directory, read its files and go over them one by one.</p><p id="186e" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To join two path strings use io::JoinPath (include tensorflow/core/lib/io/path.h)</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="5484" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">string folder_name = io::JoinPath(base_folder_name, “cats”);</span></pre><p id="05ae" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To interact with the file system use “Env”. This is a utility class (not really documented) which gives you similar facilitation like C++17 std::filesystem.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="b1d9" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Env* penv = Env::Default();</span><span id="6ad6" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_RETURN_IF_ERROR(penv-&gt;IsDirectory(folder_name));</span><span id="e6ac" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">vector&lt;string&gt; file_names;</span><span id="e83c" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_RETURN_IF_ERROR(penv-&gt;GetChildren(folder_name, &amp;file_names));</span><span id="fc4b" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">for(string file: file_names)</span><span id="6020" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">{</span><span id="aa0f" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">…</span><span id="a683" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">}</span></pre><p id="706e" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">ReadFileTensors also shuffles the images in the vector, this is so we can feed different images while training (you do not want to feed all cats and then all dogs).</p><h2 id="732e" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Creating the batches</h2><p id="6e2d" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">ReadBatches encapsulates all the logic main needs. You give it the base folder, the vectors of pair of sub-folders and labels and the size of a batch. In return you get two vectors of Tensors, one for images and one for labels. Each Tensor is a batch of images / labels according to the size you passed.</p><p id="ef64" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">First it reads the folder and its sub-folders’ content into a vector. Next it does some calculations on how to split the batches. Then it breaks the pairs of Tensors and labels to create two Input vectors where each n-th element in the Tensor vector matches the n-th element in the labels vector.</p><p id="f82d" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To stack the two vectors, we create a tiny graph on the spot and run it for each iteration.</p><p id="f659" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The results are added to the output vectors.</p><p id="910f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note how Stack operation needs to get an InputList of image tensors to stack. The easiest way is to create a vector (or another container) and instantiate the InputList with it.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="1e89" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">vector&lt;Input&gt; one_batch_image;</span><span id="8b99" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">one_batch_image.push_back(Input(tensor));</span><span id="c91f" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//Add more tensors</span><span id="9ab9" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">InputList one_batch_inputs(one_batch_image);</span><span id="e649" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Scope root = Scope::NewRootScope();</span><span id="5027" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto stacked_images = Stack(root, one_batch_inputs);</span><span id="678e" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">ClientSession session(root);</span><span id="5637" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">vector&lt;Tensor&gt; out_tensors;</span><span id="5590" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_CHECK_OK(session.Run({}, {stacked_images}, &amp;out_tensors));</span><span id="fe37" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//use out_tensors[0]</span></pre><p id="257a" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">As written above, the tensors go in as 3 dimensional tensors and the batches that are created are 4 dimensional.</p><h1 id="197e" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">CNN graph</h1><p id="0a30" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Now comes the interesting part.</p><p id="0dcb" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We would like to create a model similar to AlexNet.</p><h2 id="0ca8" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Input</h2><p id="739e" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">First we want to define the input to the graph: we already know we need to feed a batch of images:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="31d7" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">input_batch_var = Placeholder(t_root.WithOpName("input"), DT_FLOAT);</span></pre><p id="c832" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">A placeholder is like a function parameter. You specify its name and element type, but its shape is unknown at this time.</p><p id="f56b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The variable getting the result from placeholder is a member of the CatDogCNN class type Output.</p><p id="c73b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">First we use it in the graph as input to the first layer and later we will need to specify it in the ClientSession Run command together with its value (the batch Tensor).</p><p id="a25c" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Next there are a couple of placeholders which I will explain later.</p><p id="9c7d" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Unlike in the usual Python Keras networks, the C++ layers are a composition of Operations (Google calls them low level API). To know what layer each operation belongs to, we create a sub-scope per layer.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="55f6" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Scope scope_conv1 = t_root.NewSubScope("Conv1_layer");</span></pre><p id="3d6a" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The operations will be created with this scope object.</p><h2 id="99f3" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Convolution</h2><p id="226e" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">The first layer is a Convolution layer, so we need to define 4 parameters: filter height and width and in and out channels. In addition, we have the activation function (Relu) and a MaxPool operation that follows.</p><p id="cef1" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We have 4 Conv layers, so I created a function to create a generic one that includes these operations:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="96e2" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Input CatDogCNN::AddConvLayer(string idx, Scope scope, int in_channels, int out_channels, int filter_side, Input input)</span><span id="4ada" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">{</span><span id="f147" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TensorShape sp({filter_side, filter_side, in_channels, out_channels});</span><span id="9e41" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_vars["W"+idx] = Variable(scope.WithOpName("W"), sp, DT_FLOAT);</span><span id="1275" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_shapes["W"+idx] = sp;</span><span id="8cc0" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_assigns["W"+idx+"_assign"] = Assign(scope.WithOpName("W_assign"), m_vars["W"+idx], XavierInit(scope, in_channels, out_channels, filter_side));</span><span id="02eb" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">sp = {out_channels};</span><span id="e144" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_vars["B"+idx] = Variable(scope.WithOpName("B"), sp, DT_FLOAT);</span><span id="16b7" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_shapes["B"+idx] = sp;</span><span id="960c" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">m_assigns["B"+idx+"_assign"] = Assign(scope.WithOpName("B_assign"), m_vars["B"+idx], Input::Initializer(0.f, sp));</span><span id="ff1f" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto conv = Conv2D(scope.WithOpName("Conv"), input, m_vars["W"+idx], {1, 1, 1, 1}, "SAME");</span><span id="ef79" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto bias = BiasAdd(scope.WithOpName("Bias"), conv, m_vars["B"+idx]);</span><span id="074b" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto relu = Relu(scope.WithOpName("Relu"), bias);</span><span id="83bd" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">return MaxPool(scope.WithOpName("Pool"), relu, {1, 2, 2, 1}, {1, 2, 2, 1}, "SAME");</span><span id="2b8e" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">}</span></pre><p id="4cb0" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Let’s review the code:</p><p id="8b24" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">AddConvLayer gets an index string (to distinguish between layers), the sub-scope, in and out channels, a filter size (we assume same height and width) and Input input.</p><p id="f00a" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">For the first layer in channels is the number of colors the image has (3 colors) and the input is the image Tensor.</p><p id="7250" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The Conv2D operation needs a Tensor variable which holds the different filters (32 in the first layer). This variable will be changed within each step when the network in training.</p><p id="9390" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">For that reason, there is a member map m_vars that holds these variables as well as the biases. In addition, we need to store the shapes of these variables (m_shapes map) and we also need to initialize these variable with values (similar to Python variable initializer) — these operations are stored in m_assigns. Xavier initialization is popular these days, so I’ve implemented XavierInit to do that for Conv and Dense.</p><p id="c468" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">After the Conv2D there is a call to BiasAdd to add the bias (which is initialized to 0).</p><p id="6afe" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Next is a call to Relu followed by a call to MaxPool.</p><p id="7ef0" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note that for MaxPool in the Python Keras version, you only need to specify the window size with its two dimensions (e.g. 2, 2). Here we need to supply two shapes of 4 dimensions (window size and strides). To halve the size of the image in each layer, you must put 1, 2, 2, 1 in both window size and strides.</p><p id="6379" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Also note that in the CreateGraphForCNN function I track the sizes of the in and out channels since they have to match between the layers.</p><div class="xl ga xm xn ac r co"><div class="xo xp xq xr xs m ff"><h2 class="xt b xu xv xw xx xy">Get Benny Friedman’s stories in&nbsp;your&nbsp;inbox</h2></div><div class="cl m ff"><p class="bf b bg ab du">Join Medium for free to get updates from&nbsp;this&nbsp;writer.</p></div><div class="yc st yd ye ss yf ac"><span class="bf b bg ab bk"><div class="yg ac co"><div class="ac yg fc fb bp wv yh cx ne yi yj yk yl ym yn yo"><input class="yp ak ai am yq yr ys mq bl yt bh" placeholder="Enter your email" type="text" value=""></div></div></span><div class="i l ti sp"><div class="xz ya yb"><button class="bf b bg ab vg rw xe xf xg xh um ev ew xi xj xk fa fb fc fd bm fe ff">Subscribe</button></div></div><div class="bh k j e"><button class="bf b bg ab vg rw xe xf xg xh um ev ew xi xj xk fa bh fb fc fd bm fe ff">Subscribe</button></div></div><div class="ru m"><div id="g-recaptcha"></div></div></div><p id="ce96" class="pw-post-body-paragraph pc pd in pe b jl pg ph jo pj pk go pm pn gr pp pq gu ps pt xn pu ho bk" data-selectable-paragraph="">Also, since there is no way of getting the shape of the tensors coming out of operations (in is only known in runtime) we have to calculate the image size in each step.</p><h2 id="b8c0" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Flat</h2><p id="3344" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Flattening means we will have only two dimensions, the batch and the flat data.</p><p id="6deb" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To do that, we need to reshape the Tensor. Since I don’t want to hard code the batch size (I do not know whether it will be batched or not), I have to know the size of the flat data. That’s why I have these calculations done through the layers until we get flat_len.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="0156" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">auto flat = Reshape(flatten, pool4, {-1, flat_len});</span></pre><p id="6b2f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">In Reshape you are allowed to pass -1 in one of the dimensions, so it will be automatically calculated. Reshape does not add data, it only changes the way it is organized in.</p><h2 id="f364" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Dropout</h2><p id="6db8" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">This layer is in charge of dropping random neurons so the network will not overfit.</p><p id="c250" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We create a new tensor with same shape and fill it with either 0 or 1 randomly with a ratio according to the drop rate and multiply our data by it.</p><p id="bff1" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">However, when you want to validate or predict, you do not want to drop out neurons.</p><p id="b8ef" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The logical way to achieve that would be to put a condition in the graph. There are operations that support that in a very cumbersome way (Switch and Merge) but they do not support backpropagation in C++ so we can’t use them.</p><p id="e44c" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Instead I introduced two more input parameters to the network drop_rate and skip_drop so for example if you pass 0.4 and 0 respectively, you get 40% drop. If you pass 1 and 1 you get no drops.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="b624" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Scope dropout = t_root.NewSubScope("Dropout_layer");</span><span id="e209" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto rand = RandomUniform(dropout, Shape(dropout, flat), DT_FLOAT);</span><span id="aa26" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//binary = floor(rand + (1 - drop_rate) + skip_drop)</span><span id="4e51" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto binary = Floor(dropout, Add(dropout, rand, Add(dropout, Sub(dropout, 1.f, drop_rate_var), skip_drop_var)));</span><span id="b9fe" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">auto after_drop = Multiply(dropout.WithOpName("dropout"), Div(dropout, flat, drop_rate_var), binary)</span></pre><p id="d37b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">When dropping, we increase the values of the remaining neurons by dividing by the drop rate.</p><p id="b809" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note that when skip_drop is 1, the floor will turn “binary” into all ones.</p><h2 id="dcf9" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Fully Connected (Dense)</h2><p id="1656" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Next are three dense layers.</p><p id="0349" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Dense is based on multiplying by weights and adding bias. We keep the variables in the map and do the same for shapes and assigns.</p><p id="9eb8" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We also initialize the weights with Xavier init and the biases with 0.</p><p id="70ce" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note that in the last dense layer, we need to skip the Relu activation (for that we have bActivation).</p><h2 id="6f79" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Binary classification</h2><p id="a4fc" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">The last dense layer reduced the size to 1 (over batch size). This is called the logits.</p><p id="b30f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">To make logits a 0 (for cat) or 1 (for dog) we call Sigmoid and return this result out.</p><p id="2520" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">That’s how the network looks like when turning on TensorBoard (see part 1 for details):</p><figure class="qi qj qk ql qm ra qx qy paragraph-image"><div role="button" tabindex="0" class="rb rc fl rd bh re"><div class="qx qy qz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R6INLxmJU9ALePGUAYuMNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*R6INLxmJU9ALePGUAYuMNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*R6INLxmJU9ALePGUAYuMNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*R6INLxmJU9ALePGUAYuMNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*R6INLxmJU9ALePGUAYuMNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*R6INLxmJU9ALePGUAYuMNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*R6INLxmJU9ALePGUAYuMNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*R6INLxmJU9ALePGUAYuMNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bh fw rf c" width="700" height="1103" loading="lazy" role="presentation" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_R6INLxmJU9ALePGUAYuMNQ.png"></picture></div></div><figcaption class="rg ff rh qx qy ri rj bf b bg ab du" data-selectable-paragraph="">The CNN before we add optimization</figcaption></figure><p id="4ac8" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I opened one of the sub-scopes so you can see the low-level operations in the fourth convolution layer.</p><h2 id="ba75" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Optimization graph (backpropagation)</h2><p id="4302" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">This is encapsulated in the CreateOptimizationGraph function. It is not a separate graph, but additional nodes in the same graph (same t_root main scope).</p><p id="bebd" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We start with a placeholder for the labels. If the image tensors were the x, this is the y.</p><p id="24e5" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Next we calculate the loss. This is a classification problem, so we should use cross entropy however I’m not sure how to use the SoftmaxCrossEntropyWithLogits operation and could not find any meaningful information on it, so I had to use the regular mean square diff method.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="f5d4" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">input_labels_var = Placeholder(t_root.WithOpName("inputL"), DT_FLOAT);</span><span id="41b1" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Scope scope_loss = t_root.NewSubScope("Loss_scope");</span><span id="3c57" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">out_loss_var = Mean(scope_loss.WithOpName("Loss"), SquaredDifference(scope_loss, out_classification, input_labels_var), {0});</span><span id="e0fd" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_CHECK_OK(scope_loss.status());</span></pre><p id="6be2" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Next I collect all the weights and biases and send them together with the loss to the magical API call AddSymbolicGradients. This marvelous function is not an operation. It takes a graph (by its associated scope), adds all the relevant backpropagating operations and returns a vector of gradient with the same size as the number of weights and biases.</p><p id="8831" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Then we use the ApplyAdam on each variable from the weights and biases with its respective gradient.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="306f" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">auto adam = ApplyAdam(t_root, i.second, m_var, v_var, 0.f, 0.f, learning_rate, 0.9f, 0.999f, 0.00000001f, {grad_outputs[index]});</span><span id="ec69" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">v_out_grads.push_back(adam.operation);</span></pre><p id="035f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">For some reason, m_var and v_var have to be variables (they cannot be constant).</p><p id="c955" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The most important variable you pass to ApplyAdam is the learning rate. I can’t stress enough how important this value is. I started with 0.001 (from the python version) and could not stop puzzling over why the loss did not converge. Eventually I realized the optimization function jumps too long in between peaks. Only after a few days when I changed it to 0.0001 it started working. You can try different values to see how it works in your case.</p><p id="15f9" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">You can change the other values ApplyAdam is getting as well, though I’m not sure what’s the impact of that.</p><p id="ee44" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Now the TensorBoard image looks “a bit” different:</p></div></div><div class="ra"><div class="ac cb"><div class="nl rk nm rl nn rm cf rn cg ro ci bh"><figure class="qi qj qk ql qm ra rq rr paragraph-image"><div role="button" tabindex="0" class="rb rc fl rd bh re"><div class="qx qy rp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*LwH9Ap0jZH1YgrpjJzDMjA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*LwH9Ap0jZH1YgrpjJzDMjA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LwH9Ap0jZH1YgrpjJzDMjA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LwH9Ap0jZH1YgrpjJzDMjA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LwH9Ap0jZH1YgrpjJzDMjA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LwH9Ap0jZH1YgrpjJzDMjA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LwH9Ap0jZH1YgrpjJzDMjA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*LwH9Ap0jZH1YgrpjJzDMjA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="bh fw rf c" width="1000" height="361" loading="eager" role="presentation" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_LwH9Ap0jZH1YgrpjJzDMjA.png"></picture></div></div><figcaption class="rg ff rh qx qy ri rj bf b bg ab du" data-selectable-paragraph="">The CNN with optimization</figcaption></figure></div></div></div><div class="ac cb"><div class="ci bh hu hv hw hx"><h2 id="6da3" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Initialization</h2><p id="c657" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">I have already mentioned the need to initialize all the variables with the Assign operation.</p><p id="7e8f" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We collect all the m_assigns elements (also the ones we added for ApplyAdam) into a vector and run them in the created session.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="1212" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">vector&lt;Output&gt; ops_to_run;</span><span id="8edc" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">for(pair&lt;string, Output&gt; i: m_assigns)</span><span id="1e06" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">ops_to_run.push_back(i.second);</span><span id="2931" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">t_session = unique_ptr&lt;ClientSession&gt;(new ClientSession(t_root));</span><span id="e723" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_CHECK_OK(t_session-&gt;Run(ops_to_run, nullptr));</span></pre><p id="1bf1" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Leave the comments around the summary file writer code and use it only when you want to generate a new graph for TensorBoard visualization.</p><h1 id="19cc" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Training</h1><p id="ae87" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Let’s go back to main: we constructed an instance of the CatDogCNN class, created the graphs, loaded the images and ran initialization.</p><p id="df3d" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">It is time for the main epoch / step loops.</p><p id="10a7" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">An epoch is a run through all the training data. A step is a single run of a batch of images.</p><p id="8475" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We define the number of epochs, loop through them, and then loop through the batches.</p><p id="7bd4" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">In each iteration, we call TrainCNN, we call ValidateCNN and we do some calculation to check the performance of the network.</p><p id="83b9" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">TrainCNN gets a batch of images, a batch of labels (corresponding these images) and returns results and loss.</p><p id="c06b" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The function first runs the batch:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="6190" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">vector&lt;Tensor&gt; out_tensors;</span><span id="2fb3" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//Inputs: batch of images, labels, drop rate and do not skip drop.</span><span id="617b" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//Extract: Loss and result. Run also: Apply Adam commands</span><span id="aa93" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_CHECK_OK(t_session-&gt;Run({{input_batch_var, image_batch}, {input_labels_var, label_batch}, {drop_rate_var, 0.5f}, {skip_drop_var, 0.f}}, {out_loss_var, out_classification}, v_out_grads, &amp;out_tensors));</span></pre><p id="5b03" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Then it calculates accuracy. Notice the usage of Tensor methods to extract the data: out_tensors[0].scalar&lt;float&gt;()(0) to get a scalar and out_tensors[1].matrix&lt;float&gt;() to get a matrix (which is almost like a vector of vectors).</p><h2 id="c57b" class="qb oj in bf ok gk qc dy gl gm qd ea gn go qe gp gq gr qf gs gt gu qg gv gw qh bk" data-selectable-paragraph="">Validation</h2><p id="2a59" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Validation is important due to the fact we run through the network images that network never saw. If in each epoch we get better performance we are not over fitting.</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="d323" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">vector&lt;Tensor&gt; out_tensors;</span><span id="58c9" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">//Inputs: batch of images, drop rate 1 and skip drop.</span><span id="b691" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">TF_CHECK_OK(t_session-&gt;Run({{input_batch_var, image_batch}, {drop_rate_var, 1.f}, {skip_drop_var, 1.f}}, {out_classification}, &amp;out_tensors));</span></pre><p id="4f56" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Note the differences: we skip the dropout (see above for the explanation), we do not evaluate loss and we do not run the gradients.</p><p id="ffe9" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The output console looks like this:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="a39d" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Epoch 1/20:....................................................................................................</span><span id="b708" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Validation:..................................................</span><span id="5978" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Time: 74 seconds Loss: 0.243231 Results accuracy: 0.561 Validation accuracy: 0.642</span><span id="834a" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Epoch 2/20:....................................................................................................</span><span id="6a9f" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Validation:..................................................</span><span id="0026" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Time: 72 seconds Loss: 0.203312 Results accuracy: 0.6875 Validation accuracy: 0.692</span><span id="a09b" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">***</span><span id="689c" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Epoch 20/20:....................................................................................................</span><span id="c35b" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Validation:..................................................</span><span id="52e2" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Time: 73 seconds Loss: 0.041021 Results accuracy: 0.956 Validation accuracy: 0.742</span></pre><p id="d707" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The loss is constantly going down, the results accuracy is going us to 95% and the validation accuracy is going up to 75%.</p><h1 id="220b" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Testing</h1><p id="19d4" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">Let’s test the trained network.</p><p id="9a56" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">For that we need to recreate the load image graph so it will not unstack.</p><p id="b6dc" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Then we call ReadFileTensors to load the images in the test sub-folder. Lastly we run a loop of a few of them to see the performance of the network.</p><p id="7ae7" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Predict is similar to validation, though it runs a single image.</p><p id="9bab" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">The output console looks like this:</p><pre class="qi qj qk ql qm qn qo qp qq aj qr bk"><span id="7e52" class="qb oj in qo b gz qs qt m qu qv" data-selectable-paragraph="">Test number: 1 predicted: 0 actual is: 0</span><span id="0629" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Test number: 2 predicted: 1 actual is: 1</span><span id="588c" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">***</span><span id="98c9" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">Test number: 20 predicted: 0 actual is: 0</span><span id="2a38" class="qb oj in qo b gz qw qt m qu qv" data-selectable-paragraph="">total successes: 16 out of 20</span></pre><p id="a768" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">80% accuracy. There is some room for improvement, but we got better results than Arden got on his network.</p><h1 id="21e2" class="oi oj in bf ok ol om jn gl on oo jq gn op oq or os ot ou ov ow ox oy oz pa pb bk" data-selectable-paragraph="">Summary</h1><p id="7d80" class="pw-post-body-paragraph pc pd in pe b jl pf pg ph jo pi pj pk go pl pm pn gr po pp pq gu pr ps pt pu ho bk" data-selectable-paragraph="">We saw how a CNN can be implemented, trained and tested using only C++ and the TensorFlow API.</p><p id="c75a" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We saw how to prepare data (images for training, validation and test) and how to batch them so that we can feed these batches to the TensorFlow low level API.</p><p id="eece" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We implemented gradients, and other optimization methods.</p><p id="c078" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">We got good results, but there is more work to be done.</p><p id="c1b4" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Next I’m planning to do some improvements.</p><p id="b37e" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">As you can see in the console output, I’m running on my local MacBook Pro CPU and it takes a long time to run…</p><p id="0f17" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">I’m planning to implement freeze model function and GPU usage to speed things up.</p><p id="142e" class="pw-post-body-paragraph pc pd in pe b jl pw pg ph jo px pj pk go py pm pn gr pz pp pq gu qa ps pt pu ho bk" data-selectable-paragraph="">Also, I’ll see if I can do some image augmentation to create more data for the training.</p></div></div></div></div></section></div></div></article></div><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="rs rt ac kx"><div class="ru ac"><a class="rv aj an ap" rel="noopener follow" href="https://medium.com/tag/machine-learning?source=post_page-----eea0de9dcada---------------------------------------" data-discover="true"><div class="rw fl cx rx hz ry rz bf b bg ab bk fz">Machine Learning</div></a></div><div class="ru ac"><a class="rv aj an ap" rel="noopener follow" href="https://medium.com/tag/cplusplus?source=post_page-----eea0de9dcada---------------------------------------" data-discover="true"><div class="rw fl cx rx hz ry rz bf b bg ab bk fz">Cplusplus</div></a></div></div></div></div><div class="m"></div><footer class="sa sb sc sd se ac r sf sg c"><div class="m af"><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="ac cp sh"><div class="ac r mg"><div class="si m"><span class="m sj sk sl f e"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl mi mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdata-science%2Feea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;user=Benny+Friedman&amp;userId=cc3e73266fd9&amp;source=---footer_actions--eea0de9dcada---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" aria-describedby="8" aria-labelledby="8"><div tabindex="-1" class="be"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><div><div class="bm" aria-hidden="false" aria-describedby="83" aria-labelledby="83"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au yz nj">142<span class="m i h g sm sn"></span></button></p></div></div></div></div></div></span><span class="m i h g sm sn"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl mi mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerClapButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdata-science%2Feea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;user=Benny+Friedman&amp;userId=cc3e73266fd9&amp;source=---footer_actions--eea0de9dcada---------------------clap_footer------------------" data-discover="true"><div><div class="bm" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div tabindex="-1" class="be"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></div></a></span></div><div class="pw-multi-vote-count m mu mv mw mx my mz na"><div><div class="bm" aria-hidden="false" aria-describedby="85" aria-labelledby="85"><div tabindex="-1" class="be"><p class="bf b dv ab du"><button class="ag ah ai fh ak al am an ao ap aq ar as at au yz nj">142</button></p></div></div></div></div></div></span></div><div class="ay ac"><div><div class="bm" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div tabindex="-1" class="be"><button class="ap mm ne nf ac r fm ng nh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nd"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg ab du"><span class="pw-responses-count nc nd">4</span></p></button></div></div></div></div></div><div class="ac r"><div class="so m sp"><div><div class="bm" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feea0de9dcada&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=---footer_actions--eea0de9dcada---------------------bookmark_footer------------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div><div class="so m sp"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><div tabindex="-1" class="be"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></footer><div class="sq m"><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="sr m"><div class="ac kk ki kg ss st"><div class="su sv sw sx sy sz ta tb tc td ac cp"><div class="i l"><a href="https://medium.com/data-science?source=post_page---post_publication_info--eea0de9dcada---------------------------------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hj m tf te" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_JEuS4KBdakUcjg9sC7Wo4A(1).png" width="48" height="48" loading="lazy"><div class="hj m te tf fu o ft hm"></div></div></a></div><div class="k j e"><a href="https://medium.com/data-science?source=post_page---post_publication_info--eea0de9dcada---------------------------------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hj m th tg" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_JEuS4KBdakUcjg9sC7Wo4A(2).png" width="64" height="64" loading="lazy"><div class="hj m tg th fu o ft hm"></div></div></a></div><div class="k j e ti sp"><div class="ac"><button class="uk yu ap ac cb r za mf zb" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm yy">Follow</span></span></button></div></div></div><div class="ac co ca"><div class="tj tk tl rl rk m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" href="https://medium.com/data-science?source=post_page---post_publication_info--eea0de9dcada---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bf gj tn to tp tq tr ts go gp gq gr gs gt gu gv gw bk"><span class="ho tm">Published in TDS Archive</span></h2></a><div class="ru ac km"><div class="m sp"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kv" rel="noopener follow" href="https://medium.com/data-science/followers?source=post_page---post_publication_info--eea0de9dcada---------------------------------------" data-discover="true">826K followers</a></span></div><div class="bf b bg ab du ac qu"><span class="gx m" aria-hidden="true"><span class="bf b bg ab du">·</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kv" rel="noopener follow" href="https://medium.com/data-science/diy-ai-how-to-build-a-linear-regression-model-from-scratch-7b4cc0efd235?source=post_page---post_publication_info--eea0de9dcada---------------------------------------" data-discover="true">Last published&nbsp;<span>Feb 3, 2025</span></a></div></div><div class="hn m"><p class="bf b bg ab bk"><span class="ho">An archive of data science, data analytics, data engineering, machine learning, and artificial intelligence writing from the former Towards Data Science Medium publication.</span></p></div></div></div><div class="i l"><div class="ac"><button class="uk yu ap ac cb r za mf zb" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm yy">Follow</span></span></button></div></div></div></div><div class="ac kk ki kg ss st"><div class="su sv sw sx sy sz ta tb tc td ac cp"><div class="i l"><a tabindex="0" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---post_author_info--eea0de9dcada---------------------------------------" data-discover="true"><div class="m fl"><img alt="Benny Friedman" class="m fd bx te tf cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2_-kLmQWFvXHMQAf6yZ88THA(1).png" width="48" height="48" loading="lazy"><div class="ft bx m te tf fu o aj hm"></div></div></a></div><div class="k j e"><a tabindex="0" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---post_author_info--eea0de9dcada---------------------------------------" data-discover="true"><div class="m fl"><img alt="Benny Friedman" class="m fd bx tg th cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2_-kLmQWFvXHMQAf6yZ88THA(2).png" width="64" height="64" loading="lazy"><div class="ft bx m tg th fu o aj hm"></div></div></a></div><div class="k j e ti sp"><div class="ac"><div class="bm" aria-hidden="false"><button class="uk yu ap ac cb r za mf zb" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm yy">Follow</span></span></button></div></div></div></div><div class="ac co ca"><div class="tj tk tl rl rk m"><a class="ag ah ai ak al am an ao ap aq ar as at au ac r" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---post_author_info--eea0de9dcada---------------------------------------" data-discover="true"><h2 class="pw-author-name bf gj tn to tp tq tr ts go gp gq gr gs gt gu gv gw bk"><span class="ho tm">Written by Benny Friedman</span></h2></a><div class="ru ac km"><div class="m sp"><span class="pw-follower-count bf b bg ab du"><a class="ag ah ai fh ak al am an ao ap aq ar as kv" rel="noopener follow" href="https://medium.com/@bennyfriedman/followers?source=post_page---post_author_info--eea0de9dcada---------------------------------------" data-discover="true">137 followers</a></span></div><div class="bf b bg ab du ac qu"><span class="gx m" aria-hidden="true"><span class="bf b bg ab du">·</span></span><a class="ag ah ai fh ak al am an ao ap aq ar as kv" rel="noopener follow" href="https://medium.com/@bennyfriedman/following?source=post_page---post_author_info--eea0de9dcada---------------------------------------" data-discover="true">34 following</a></div></div><div class="hn m"><p class="bf b bg ab bk"><span class="ho">I manage the Engineering group of the Israeli Flipkart branch</span></p></div></div></div><div class="i l"><div class="ac"><div class="bm" aria-hidden="false"><button class="uk yu ap ac cb r za mf zb" style="border: 1px solid rgb(36, 36, 36);"><span class="bf b bg ab bk bh"><span class="bm yy">Follow</span></span></button></div></div></div></div></div></div></div><div class="tt tu tv tw tx m"><div class="ty bh s sq"></div><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="ac r cp"><h2 class="bf gj ol jn gl on jq gn op or os ot ov ow ox oz pa bk">Responses (4)</h2><div class="ac tz"><div><div class="bm" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><div tabindex="-1" class="be"><a class="ua ub" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--eea0de9dcada---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="uc ga ud ue uf ug uh m"><div><div class="bf b bg ab bk"><div class="ha"><div class="wt m"><div class="wu ac r"><div class="m fl"><img alt="" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="ft bx m by bz fu o aj hm"></div></div><div class="bn ac cn co cb"><p class="bf b bg ab du">Write a response</p></div></div><div class="cx bp ac co wm wn"><div class="ac co fl"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada&amp;source=---post_responses--eea0de9dcada---------------------respond_sidebar------------------" data-discover="true"><div class="wv m"><p class="bf b bg ab du">What are your thoughts?</p></div></a></span><div class="cp wo du ac wp hg wq"><span class="bf b bg ab du"><div class="ac"><div><div class="bm" aria-hidden="false" aria-describedby="40" aria-labelledby="40"><div tabindex="-1" class="be"><span class="ww wx wy wz bp nk cb xa xb xc"><svg width="21" height="21"><path fill-rule="evenodd" d="M10.308 17.993h-5.92l.11-.894.783-.12c.56-.11.79-.224.79-.448V5.37c0-.225-.113-.336-.902-.448H4.5l-.114-.894h6.255c4.02 0 5.58 1.23 5.58 3.13 0 1.896-1.78 3.125-3.79 3.463v.11c2.69.34 4.25 1.56 4.25 3.57 0 2.35-2.01 3.69-6.37 3.69l.02.01h-.02zm-.335-12.96H8.967V10.5h1.23c1.788 0 2.79-1.23 2.79-2.683 0-1.685-1.004-2.803-3.006-2.803v.02zm-.223 6.36h-.783v5.588l1.225.23h.22c1.67 0 3.01-1.004 3.01-2.792 0-2.122-1.566-3.016-3.69-3.016h.018z"></path></svg></span></div></div></div><div><div class="bm" aria-hidden="false" aria-describedby="41" aria-labelledby="41"><div tabindex="-1" class="be"><span class="ww wx wy wz bp nk cb xa xb xc"><svg width="21" height="21"><path fill-rule="evenodd" d="M9.847 18.04c-.533 0-2.027-.64-1.92-.853l2.027-7.68-.64-.214-1.387 1.494-.427-.427c.534-1.173 1.707-2.667 2.774-2.667.533 0 2.24.534 2.133.854l-2.133 7.786.533.214 1.6-1.067.427.427c-.64 1.066-1.92 2.133-2.987 2.133m2.347-11.733c-.96 0-1.387-.64-1.387-1.387 0-1.067.747-1.92 1.493-1.92.854 0 1.387.64 1.387 1.493-.107 1.067-.747 1.814-1.493 1.814"></path></svg></span></div></div></div></div></span><div class="wr ti ac wp hg wq"><div class="ws"><button class="bf b dv ab bk xd uj uk ul nj ng um ev ew ex un uo up fa fb fc fd bm fe ff" data-testid="CancelResponseButton">Cancel</button></div><button class="bf b dv ab vg xd xe xf xg xh um ev ew xi xj xk fa fb fc fd bm fe ff" disabled="" data-testid="ResponseRespondButton">Respond</button></div></div></div></div></div></div></div></div></div><div class="ga m"><div class="bh dw"><div class="zc zd m"><div class="ac cp"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="96" aria-labelledby="96"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@yogeshgupta813?source=post_page---post_responses--eea0de9dcada----0-----------------------------------" data-discover="true"><div class="m fl"><div class="m fl"><img alt="YOGESH GUPTA" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/0_5LcxQlueGQNQZVKh.png" width="32" height="32" loading="lazy"><div class="ft bx m by bz fu o aj fv"></div></div></div></a></div></div></div><div class="ze m"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="97" aria-labelledby="97"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au ac r zf zg" rel="noopener follow" href="https://medium.com/@yogeshgupta813?source=post_page---post_responses--eea0de9dcada----0-----------------------------------" data-discover="true"><div class="ac km zf"><p class="bf b bg ab fx zh fy zi zj zk zl zm bk">YOGESH GUPTA</p></div></a></div></div></div></div><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@yogeshgupta813/hi-eef17be220e0?source=post_page---post_responses--eea0de9dcada----0-----------------------------------" data-discover="true"><p class="bf b dv ab du"><span>Apr 26, 2022</span></p></a></div></div><div class="bm" aria-hidden="false"><button class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="zn m ho"><pre class="qu"><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Hi</div></div></div><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Thanks for the nice article.</div></div></div><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Do you have any idea on how to implement a LSTM model in c++ ?</div></div></div><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Thanks</div></div></div></pre></div><div class="zp ac r mg cp"><div class="ac r zq"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl afq mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Feef17be220e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40yogeshgupta813%2Fhi-eef17be220e0&amp;user=YOGESH+GUPTA&amp;userId=20b28b304e6a&amp;source=---post_responses--eef17be220e0----0-----------------respond_sidebar------------------" data-discover="true"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div></div><p class="bf b dv ab bk"><button class="ag ah ai fh ak al am an ao ap aq ar as pv">Reply</button></p></div></div></div></div></div><div class="ga m"><div class="bh dw"><div class="zc zd m"><div class="ac cp"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="98" aria-labelledby="98"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@CuteCrazy?source=post_page---post_responses--eea0de9dcada----1-----------------------------------" data-discover="true"><div class="m fl"><div class="m fl"><img alt="Barry Liang" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/0_MEd5uOSJ_3U51NaN.jpg" width="32" height="32" loading="lazy"><div class="ft bx m by bz fu o aj fv"></div></div></div></a></div></div></div><div class="ze m"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="99" aria-labelledby="99"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au ac r zf zg" rel="noopener follow" href="https://medium.com/@CuteCrazy?source=post_page---post_responses--eea0de9dcada----1-----------------------------------" data-discover="true"><div class="ac km zf"><p class="bf b bg ab fx zh fy zi zj zk zl zm bk">Barry Liang</p></div></a></div></div></div></div><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@CuteCrazy/hello-benny-how-can-i-use-globalaveragepooling-to-replace-flatten-thanks-b0509b4aad58?source=post_page---post_responses--eea0de9dcada----1-----------------------------------" data-discover="true"><p class="bf b dv ab du"><span>Oct 6, 2020</span></p></a></div></div><div class="bm" aria-hidden="false"><button class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="zn m ho"><pre class="qu"><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Hello Benny, how can I use GlobalAveragePooling to replace flatten. Thanks</div></div></div></pre></div><div class="zp ac r mg cp"><div class="ac r zq"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl afq mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fb0509b4aad58&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40CuteCrazy%2Fhello-benny-how-can-i-use-globalaveragepooling-to-replace-flatten-thanks-b0509b4aad58&amp;user=Barry+Liang&amp;userId=3986db8efaeb&amp;source=---post_responses--b0509b4aad58----1-----------------respond_sidebar------------------" data-discover="true"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div></div><button class="ag fm ai fh ak al am an ao ap aq ar as at au ac r zf nj ng nh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="responses"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du">1 reply</p></button><p class="bf b dv ab bk"><button class="ag ah ai fh ak al am an ao ap aq ar as pv">Reply</button></p></div></div></div></div></div><div class="ga m"><div class="bh dw"><div class="zc zd m"><div class="ac cp"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="100" aria-labelledby="100"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@makquel?source=post_page---post_responses--eea0de9dcada----2-----------------------------------" data-discover="true"><div class="m fl"><div class="m fl"><img alt="Miguel Ángel Cárdenas" class="m fd bx by bz cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2_sCTuj0kNwEAFSJIDxhn9lQ.jpg" width="32" height="32" loading="lazy"><div class="ft bx m by bz fu o aj fv"></div></div></div></a></div></div></div><div class="ze m"><div class="ac r"><div><div class="bm" aria-hidden="false" aria-describedby="101" aria-labelledby="101"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as at au ac r zf zg" rel="noopener follow" href="https://medium.com/@makquel?source=post_page---post_responses--eea0de9dcada----2-----------------------------------" data-discover="true"><div class="ac km zf"><p class="bf b bg ab fx zh fy zi zj zk zl zm bk">Miguel Ángel Cárdenas</p></div></a></div></div></div></div><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://makquel.medium.com/hi-benny-that-was-quite-insighful-im-wondering-what-s-the-tool-you-use-for-graph-plotting-best-8fb91a6f84ae?source=post_page---post_responses--eea0de9dcada----2-----------------------------------" rel="noopener follow"><p class="bf b dv ab du"><span>Aug 13, 2020</span></p></a></div></div><div class="bm" aria-hidden="false"><button class="ag fm ai fh ak al am nq ao ap aq ex nr ns nh nt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"></path></svg></button></div></div><div class="zn m ho"><pre class="qu"><div class="zo m"><div class="bf b bg ab bk"><div class="ha">Hi Benny, that was quite insighful, I'm wondering what's the tool you use for graph plotting. Best</div></div></div></pre></div><div class="zp ac r mg cp"><div class="ac r zq"><div class="ac r mg mh"><div class="pw-multi-vote-icon fl afq mj mk ml"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8fb91a6f84ae&amp;operation=register&amp;redirect=https%3A%2F%2Fmakquel.medium.com%2Fhi-benny-that-was-quite-insighful-im-wondering-what-s-the-tool-you-use-for-graph-plotting-best-8fb91a6f84ae&amp;user=Miguel+%C3%81ngel+C%C3%A1rdenas&amp;userId=fc7326eb0dd8&amp;source=---post_responses--8fb91a6f84ae----2-----------------respond_sidebar------------------" data-discover="true"><div class="mm ap mn mo mp mq an mr ms mt ml" role="presentation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></a></span></div></div><button class="ag fm ai fh ak al am an ao ap aq ar as at au ac r zf nj ng nh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="responses"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv ab du">1 reply</p></button><p class="bf b dv ab bk"><button class="ag ah ai fh ak al am an ao ap aq ar as pv">Reply</button></p></div></div></div></div></div><div class="ui m"><button class="bf b bg ab bk rw uj uk ul nj ng um ev ew ex un uo up fa uq ur us ut uu fb fc fd bm fe ff">See all responses</button></div></div></div></div><div class="uv uw ux uy uz m bw"><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="zr zs dm dn do hn m"><h2 class="bf gj ol jn gl on jq gn op or os ot ov ow ox oz pa bk">More from Benny Friedman and TDS Archive</h2></div><div class="zt ac mg kx zu zv zw zx zy zz aba abb abc abd abe abf abg abh abi"><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/itnext/creating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586" tabindex="0"><div class="acu"><div aria-label="Creating a TensorFlow DNN in C++ Part 1"><div class="acw acx acy acz ada"><img alt="Creating a TensorFlow DNN in C++ Part 1" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_fp4k4wdGS9vNdfBYyQV6dQ.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="126" aria-labelledby="126"><div tabindex="-1" class="be"><a href="https://medium.com/itnext?source=post_page---author_recirc--eea0de9dcada----0---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><div class="fl"><img alt="ITNEXT" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_yAqDFIFA5F_NXalOJKz4TA.png" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="127" aria-labelledby="127"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/itnext?source=post_page---author_recirc--eea0de9dcada----0---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">ITNEXT</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="128" aria-labelledby="128"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---author_recirc--eea0de9dcada----0---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Benny Friedman</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/itnext/creating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586?source=post_page---author_recirc--eea0de9dcada----0---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Creating a TensorFlow DNN in C++ Part 1</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">In this post I’ll start with data preparation, a small graph and use TensorBoard.</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><span>May 8, 2019</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/itnext/creating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586?source=post_page---author_recirc--eea0de9dcada----0---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="272" aria-labelledby="272"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>250</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="129" aria-labelledby="129"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="130" aria-labelledby="130"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54ce69bbd586&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fcreating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586&amp;source=---author_recirc--eea0de9dcada----0-----------------bookmark_preview----90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/data-science/top-12-skills-data-scientists-need-to-succeed-in-2025-c80f54cf227a" tabindex="0"><div class="acu"><div aria-label="Top 12 Skills Data Scientists Need to Succeed in 2025"><div class="acw acx acy acz ada"><img alt="Top 12 Skills Data Scientists Need to Succeed in 2025" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_3-dsgcblaLxWwL-qtDPLxA.gif" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="131" aria-labelledby="131"><div tabindex="-1" class="be"><a href="https://medium.com/data-science?source=post_page---author_recirc--eea0de9dcada----1---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_JEuS4KBdakUcjg9sC7Wo4A(3).png" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="132" aria-labelledby="132"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/data-science?source=post_page---author_recirc--eea0de9dcada----1---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">TDS Archive</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="133" aria-labelledby="133"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@benjybo7?source=post_page---author_recirc--eea0de9dcada----1---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Benjamin Bodner</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/data-science/top-12-skills-data-scientists-need-to-succeed-in-2025-c80f54cf227a?source=post_page---author_recirc--eea0de9dcada----1---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Top 12 Skills Data Scientists Need to Succeed in 2025</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">It’s (not) all about LLMs and AI tools</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="134" aria-labelledby="134"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="135" aria-labelledby="135"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Dec 31, 2024</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/data-science/top-12-skills-data-scientists-need-to-succeed-in-2025-c80f54cf227a?source=post_page---author_recirc--eea0de9dcada----1---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="274" aria-labelledby="274"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>2.8K</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="136" aria-labelledby="136"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>40</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="137" aria-labelledby="137"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc80f54cf227a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Ftop-12-skills-data-scientists-need-to-succeed-in-2025-c80f54cf227a&amp;source=---author_recirc--eea0de9dcada----1-----------------bookmark_preview----90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/data-science/enterprise-ready-knowledge-graphs-96028d863e8c" tabindex="0"><div class="acu"><div aria-label="How to Build a Knowledge Graph in Minutes (And Make It Enterprise-Ready)"><div class="acw acx acy acz ada"><img alt="How to Build a Knowledge Graph in Minutes (And Make It Enterprise-Ready)" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/0_g4x6_WGJEDaWUSmS.jpg" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="138" aria-labelledby="138"><div tabindex="-1" class="be"><a href="https://medium.com/data-science?source=post_page---author_recirc--eea0de9dcada----2---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><div class="fl"><img alt="TDS Archive" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_JEuS4KBdakUcjg9sC7Wo4A(3).png" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="139" aria-labelledby="139"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/data-science?source=post_page---author_recirc--eea0de9dcada----2---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">TDS Archive</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="140" aria-labelledby="140"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@thuwarakesh?source=post_page---author_recirc--eea0de9dcada----2---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Thuwarakesh Murallie</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/data-science/enterprise-ready-knowledge-graphs-96028d863e8c?source=post_page---author_recirc--eea0de9dcada----2---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div title="How to Build a Knowledge Graph in Minutes (And Make It Enterprise-Ready)"><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">How to Build a Knowledge Graph in Minutes (And Make It Enterprise-Ready)</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">I tried and failed creating one—but it was when LLMs were not a thing!</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="141" aria-labelledby="141"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="142" aria-labelledby="142"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Jan 13</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/data-science/enterprise-ready-knowledge-graphs-96028d863e8c?source=post_page---author_recirc--eea0de9dcada----2---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="276" aria-labelledby="276"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>1.2K</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="143" aria-labelledby="143"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>9</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="144" aria-labelledby="144"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96028d863e8c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fdata-science%2Fenterprise-ready-knowledge-graphs-96028d863e8c&amp;source=---author_recirc--eea0de9dcada----2-----------------bookmark_preview----90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/itnext/how-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80" tabindex="0"><div class="acu"><div aria-label="How to use your C++ muscle using TensorFlow 2.0 and XCode (without using Bazel builds)"><div class="acw acx acy acz ada"><img alt="How to use your C++ muscle using TensorFlow 2.0 and XCode (without using Bazel builds)" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_0WGmNiI2E9sBXfL6wBI3gg.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="145" aria-labelledby="145"><div tabindex="-1" class="be"><a href="https://medium.com/itnext?source=post_page---author_recirc--eea0de9dcada----3---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><div class="fl"><img alt="ITNEXT" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_yAqDFIFA5F_NXalOJKz4TA.png" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="146" aria-labelledby="146"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/itnext?source=post_page---author_recirc--eea0de9dcada----3---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">ITNEXT</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="147" aria-labelledby="147"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---author_recirc--eea0de9dcada----3---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Benny Friedman</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/itnext/how-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80?source=post_page---author_recirc--eea0de9dcada----3---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div title="How to use your C++ muscle using TensorFlow 2.0 and XCode (without using Bazel builds)"><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">How to use your C++ muscle using TensorFlow 2.0 and XCode (without using Bazel builds)</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">This post will describe how to code in C++ using TensorFlow, on a Mac, while bypassing Bazel builds, which I find too cumbersome to use.</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><span>Apr 16, 2019</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/itnext/how-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80?source=post_page---author_recirc--eea0de9dcada----3---------------------90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="278" aria-labelledby="278"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>159</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="148" aria-labelledby="148"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>11</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="149" aria-labelledby="149"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9dc82d5e7f80&amp;operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80&amp;source=---author_recirc--eea0de9dcada----3-----------------bookmark_preview----90db2861_56be_40fd_9b2f_5e134c4e0c18--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="ty bh va dk dl aex aey aez"></div><div class="ac st ss kg ki kk"><a class="bf b bg ab bk rw uj uk ul nj ng um ev ew ex un uo up fa uq ur us ut uu fb fc fd bm fe ff" rel="noopener follow" href="https://medium.com/@bennyfriedman?source=post_page---author_recirc--eea0de9dcada---------------------------------------" data-discover="true"><div class="m ff">See all from Benny Friedman</div></a><div class="afa afb afc afd afe aff afg afh afi na m"><a class="bf b bg ab bk rw uj uk ul nj ng um ev ew ex un uo up fa uq ur us ut uu fb fc fd bm fe ff" href="https://medium.com/data-science?source=post_page---author_recirc--eea0de9dcada---------------------------------------" rel="noopener follow"><div class="m ff">See all from TDS Archive</div></a></div></div></div></div><div class="ty bh va afj afk afl afm afn"></div><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="afo afp m"><h2 class="bf gj ol jn gl on jq gn op or os ot ov ow ox oz pa bk">Recommended from Medium</h2><div class="qi qj qk ql qm m"><div class="zt ac mg kx zu zv zw zx zy zz aba abb abc abd abe abf abg abh abi"><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/imagecraft/image-histogram-analysis-e2f65635309d" tabindex="0"><div class="acu"><div aria-label="Image histogram analysis"><div class="acw acx acy acz ada"><img alt="Image histogram analysis" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/0_vlstIwtxyXXc7xWr.jpg" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="150" aria-labelledby="150"><div tabindex="-1" class="be"><a href="https://medium.com/imagecraft?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><div class="fl"><img alt="ImageCraft" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_vdMjMWE-eSabVCbxTd79Eg.jpg" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="151" aria-labelledby="151"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/imagecraft?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">ImageCraft</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="152" aria-labelledby="152"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@fjzavala?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Francisco Zavala</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/imagecraft/image-histogram-analysis-e2f65635309d?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Image histogram analysis</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">Histogram Calculation Explained: Counting Pixel Frequencies Across channel Levels.</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="153" aria-labelledby="153"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="154" aria-labelledby="154"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Mar 13</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/imagecraft/image-histogram-analysis-e2f65635309d?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="280" aria-labelledby="280"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="155" aria-labelledby="155"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe2f65635309d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fimagecraft%2Fimage-histogram-analysis-e2f65635309d&amp;source=---read_next_recirc--eea0de9dcada----0-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/@wangdk93/c-singleton-multi-thread-safe-74f18082d770" tabindex="0"><div class="acu"><div aria-label="C++ singleton multi-thread safe"><div class="acw acx acy acz ada"><img alt="C++ singleton multi-thread safe" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_yuVzMhCJyDENbyhwAsrkwA.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="156" aria-labelledby="156"><div tabindex="-1" class="be"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@wangdk93?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div class="m fl"><img alt="noplaxochia" class="m fd bx adn ado cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/0_6mkOkLOKMeFCpz6a.jpg" width="20" height="20" loading="lazy"><div class="ft bx m adn ado fu o aj fv"></div></div></a></div></div></div></div></div><div><div class="m" aria-hidden="false" aria-describedby="157" aria-labelledby="157"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@wangdk93?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">noplaxochia</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@wangdk93/c-singleton-multi-thread-safe-74f18082d770?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">C++ singleton multi-thread safe</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">std::call_once</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="158" aria-labelledby="158"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="159" aria-labelledby="159"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Feb 1</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/@wangdk93/c-singleton-multi-thread-safe-74f18082d770?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="281" aria-labelledby="281"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>17</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="160" aria-labelledby="160"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="161" aria-labelledby="161"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F74f18082d770&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40wangdk93%2Fc-singleton-multi-thread-safe-74f18082d770&amp;source=---read_next_recirc--eea0de9dcada----1-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="zt ac mg kx zu zv zw zx zy zz aba abb abc abd abe abf abg abh abi"><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/long-sweet-valuable/ill-instantly-know-you-used-chat-gpt-if-i-see-this-d0a635bc0a00" tabindex="0"><div class="acu"><div aria-label="I’ll Instantly Know You Used Chat Gpt If I See This"><div class="acw acx acy acz ada"><img alt="I’ll Instantly Know You Used Chat Gpt If I See This" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_dRtGFgNbdBRFp5DOOWB2sw@2x.jpg" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="162" aria-labelledby="162"><div tabindex="-1" class="be"><a href="https://medium.com/long-sweet-valuable?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><div class="fl"><img alt="Long. Sweet. Valuable." class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_8-CMNGG1bFXJByHYeDNKvw.jpg" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="163" aria-labelledby="163"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/long-sweet-valuable?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Long. Sweet. Valuable.</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="164" aria-labelledby="164"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@ossaichinedum?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Ossai Chinedum</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/long-sweet-valuable/ill-instantly-know-you-used-chat-gpt-if-i-see-this-d0a635bc0a00?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">I’ll Instantly Know You Used Chat Gpt If I See This</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">Trust me you’re not as slick as you think</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="165" aria-labelledby="165"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="166" aria-labelledby="166"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>May 16</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/long-sweet-valuable/ill-instantly-know-you-used-chat-gpt-if-i-see-this-d0a635bc0a00?source=post_page---read_next_recirc--eea0de9dcada----0---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="283" aria-labelledby="283"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>14.3K</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="167" aria-labelledby="167"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>833</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="168" aria-labelledby="168"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0a635bc0a00&amp;operation=register&amp;redirect=https%3A%2F%2Flong.sweet.pub%2Fill-instantly-know-you-used-chat-gpt-if-i-see-this-d0a635bc0a00&amp;source=---read_next_recirc--eea0de9dcada----0-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/gitconnected/building-a-complex-production-ready-rag-system-with-langchain-langgraph-and-ragas-36a66d663c5c" tabindex="0"><div class="acu"><div aria-label="Building a Complex, Production-Ready RAG System with LangChain, LangGraph, and RAGAS"><div class="acw acx acy acz ada"><img alt="Building a Complex, Production-Ready RAG System with LangChain, LangGraph, and RAGAS" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_-neV95FnEltYAuvIE3w8cQ.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div><div class="m" aria-hidden="false" aria-describedby="169" aria-labelledby="169"><div tabindex="-1" class="be"><a href="https://medium.com/gitconnected?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><div class="fl"><img alt="Level Up Coding" class="cx hj m ado adn" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_5D9oYBd58pyjMkV_5-zXXQ.jpg" width="20" height="20" loading="lazy"><div class="hj m adn ado fu o ft fv"></div></div></a></div></div></div></div><div class="tm m"><p class="bf b dv ab du">In</p></div><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="170" aria-labelledby="170"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" href="https://medium.com/gitconnected?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" rel="noopener follow"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Level Up Coding</p></a></div></div></div></div><div class="adp m"><p class="bf b dv ab du">by</p></div><div><div class="m" aria-hidden="false" aria-describedby="171" aria-labelledby="171"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@fareedkhandev?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Fareed Khan</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/gitconnected/building-a-complex-production-ready-rag-system-with-langchain-langgraph-and-ragas-36a66d663c5c?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title="Building a Complex, Production-Ready RAG System with LangChain, LangGraph, and RAGAS"><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Building a Complex, Production-Ready RAG System with LangChain, LangGraph, and RAGAS</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">Logical chunking, agents, sub-graphs, plan execution, evaluation, and more.</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="172" aria-labelledby="172"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="173" aria-labelledby="173"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div>4d ago<div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/gitconnected/building-a-complex-production-ready-rag-system-with-langchain-langgraph-and-ragas-36a66d663c5c?source=post_page---read_next_recirc--eea0de9dcada----1---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="285" aria-labelledby="285"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>503</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="174" aria-labelledby="174"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>2</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="175" aria-labelledby="175"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36a66d663c5c&amp;operation=register&amp;redirect=https%3A%2F%2Flevelup.gitconnected.com%2Fbuilding-a-complex-production-ready-rag-system-with-langchain-langgraph-and-ragas-36a66d663c5c&amp;source=---read_next_recirc--eea0de9dcada----1-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/@emiruzunn/common-cnn-architectures-lenet-alexnet-vgg-and-resnet-c98965c85980" tabindex="0"><div class="acu"><div aria-label="Common CNN Architectures: LeNet, AlexNet, VGG, and ResNet"><div class="acw acx acy acz ada"><img alt="Common CNN Architectures: LeNet, AlexNet, VGG, and ResNet" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_W3bmifoY7E0MFbchjHLM_Q.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="176" aria-labelledby="176"><div tabindex="-1" class="be"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@emiruzunn?source=post_page---read_next_recirc--eea0de9dcada----2---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div class="m fl"><img alt="Emir Uzun" class="m fd bx adn ado cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_LmZC_dWRPNmSO4eub8d0KA.png" width="20" height="20" loading="lazy"><div class="ft bx m adn ado fu o aj fv"></div></div></a></div></div></div></div></div><div><div class="m" aria-hidden="false" aria-describedby="177" aria-labelledby="177"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@emiruzunn?source=post_page---read_next_recirc--eea0de9dcada----2---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Emir Uzun</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@emiruzunn/common-cnn-architectures-lenet-alexnet-vgg-and-resnet-c98965c85980?source=post_page---read_next_recirc--eea0de9dcada----2---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Common CNN Architectures: LeNet, AlexNet, VGG, and ResNet</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">We will summarize the logic and functionality of popular CNN architectures. LeNet,AlexNet,VGG, ResNet.</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><div class="se ac"><div class="bm" aria-hidden="false" aria-describedby="178" aria-labelledby="178"><button class="m aj ap an" aria-label="Member-only story"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="179" aria-labelledby="179"><div tabindex="-1" class="be"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 64 64"><path fill="#FFC017" d="m39.637 40.831-5.771 15.871a1.99 1.99 0 0 1-3.732 0l-5.771-15.87a2.02 2.02 0 0 0-1.194-1.195L7.298 33.866a1.99 1.99 0 0 1 0-3.732l15.87-5.771a2.02 2.02 0 0 0 1.195-1.194l5.771-15.871a1.99 1.99 0 0 1 3.732 0l5.771 15.87a2.02 2.02 0 0 0 1.194 1.195l15.871 5.771a1.99 1.99 0 0 1 0 3.732l-15.87 5.771a2.02 2.02 0 0 0-1.195 1.194"></path></svg></div></div></div></div></button></div></div><span>Jan 11</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/@emiruzunn/common-cnn-architectures-lenet-alexnet-vgg-and-resnet-c98965c85980?source=post_page---read_next_recirc--eea0de9dcada----2---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="287" aria-labelledby="287"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>53</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="180" aria-labelledby="180"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc98965c85980&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40emiruzunn%2Fcommon-cnn-architectures-lenet-alexnet-vgg-and-resnet-c98965c85980&amp;source=---read_next_recirc--eea0de9dcada----2-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span><div class="k j e"><div class="ty bh va nd"></div></div></div></div></div></div></div></div></article></div></div><div class="abj abk abl rk abm abn abo rl abp abq abr abs abt abu abv abw abx aby abz aca acb"><div class="acc acd ace acf acg dw m"><article class="dw" data-testid="post-preview"><div class="dw se m"><div class="bh dw"><div class="dw m"><div class="fl dw ach aci acj ack acl acm acn aco acp acq acr acs act" role="link" data-href="https://medium.com/@RobuRishabh/beginners-guide-to-linked-list-in-c-d8445ef906ab" tabindex="0"><div class="acu"><div aria-label="Beginner’s Guide to Linked List in C++"><div class="acw acx acy acz ada"><img alt="Beginner’s Guide to Linked List in C++" class="bh adb adc add bw" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_iB0i489kApgtk4tl5gRirw.png" loading="lazy"></div></div></div><div class="acv ac cb co"><div class="ac co wi bh ade adf adg adh"><div class="adi adj adk adl adm ac r"><div class="rv m"><div class="m"><div><div class="m" aria-hidden="false" aria-describedby="181" aria-labelledby="181"><div tabindex="-1" class="be"><a tabindex="-1" rel="noopener follow" href="https://medium.com/@RobuRishabh?source=post_page---read_next_recirc--eea0de9dcada----3---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div class="m fl"><img alt="Rishabh Singh" class="m fd bx adn ado cx" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1_rc0VhtLteg3w-0WiCgBjFA.jpg" width="20" height="20" loading="lazy"><div class="ft bx m adn ado fu o aj fv"></div></div></a></div></div></div></div></div><div><div class="m" aria-hidden="false" aria-describedby="182" aria-labelledby="182"><div tabindex="-1" class="be"><a class="ag ah ai fh ak al am an ao ap aq ar as kv ac r" rel="noopener follow" href="https://medium.com/@RobuRishabh?source=post_page---read_next_recirc--eea0de9dcada----3---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><p class="bf b dv ab fx zh fy zi zj zk zl zm bk">Rishabh Singh</p></a></div></div></div></div><div class="adq m adr ads adt adu adv ho"><div class="adw adx ady adz aea aeb aec aed"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/@RobuRishabh/beginners-guide-to-linked-list-in-c-d8445ef906ab?source=post_page---read_next_recirc--eea0de9dcada----3---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div title=""><h2 class="bf io ol jn aee aef gl on jq aeg aeh gn go gp aei aej gq gr gs aek ael gt gu gv aem aen gw fx fy zi zk zm bk">Beginner’s Guide to Linked List in C++</h2></div><div class="aeo m"><h3 class="bf b gz ab fx aep fy zi aeq zk zm du">Linked List is a linear data structure in which the elements are not stored at contiguous memory locations. The elements in a linked list…</h3></div></a></div></div><span class="bf b dv ab du"><div class="te ac cp af"><div class="ac r aet"><span>Jan 6</span><div class=""><div class="fl aer dh ac r"><div class="fu hg aes ac r aet"><div class="fg dh dj m cx"></div></div><a class="fu ne aes ac r aet" tabindex="-1" rel="noopener follow" href="https://medium.com/@RobuRishabh/beginners-guide-to-linked-list-in-c-d8445ef906ab?source=post_page---read_next_recirc--eea0de9dcada----3---------------------f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><div><div class="ac" aria-hidden="false" aria-describedby="288" aria-labelledby="288"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" aria-labelledby="clap-filled-static-desc" viewBox="0 0 16 16"><desc id="clap-filled-static-desc">A clap icon</desc><path fill="#6B6B6B" fill-rule="evenodd" d="m3.672 10.167 2.138 2.14h-.002c1.726 1.722 4.337 2.436 5.96.81 1.472-1.45 1.806-3.68.76-5.388l-1.815-3.484c-.353-.524-.849-1.22-1.337-.958-.49.261 0 1.56 0 1.56l.78 1.932L6.43 2.866c-.837-.958-1.467-1.108-1.928-.647-.33.33-.266.856.477 1.598.501.503 1.888 1.957 1.888 1.957.17.174.083.485-.093.655a.56.56 0 0 1-.34.163.43.43 0 0 1-.317-.135s-2.4-2.469-2.803-2.87c-.344-.346-.803-.54-1.194-.15-.408.406-.273 1.065.11 1.447.345.346 2.31 2.297 2.685 2.67l.062.06c.17.175.269.628.093.8-.193.188-.453.33-.678.273a.9.9 0 0 1-.446-.273S2.501 6.84 1.892 6.23c-.407-.406-.899-.333-1.229 0-.525.524.263 1.28 1.73 2.691.384.368.814.781 1.279 1.246m8.472-7.219c.372-.29.95-.28 1.303.244V3.19l1.563 3.006.036.074c.885 1.87.346 4.093-.512 5.159l-.035.044c-.211.264-.344.43-.74.61 1.382-1.855.963-3.478-.248-5.456L11.943 3.88l-.002-.037c-.017-.3-.039-.71.203-.895" clip-rule="evenodd"></path></svg><span>143</span></div></div></div></div><div><div class="ac" aria-hidden="false" aria-describedby="183" aria-labelledby="183"><div tabindex="-1" class="be"><div class="ac r zf"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#6B6B6B" aria-labelledby="response-filled-16px-desc" viewBox="0 0 16 16"><desc id="response-filled-16px-desc">A response icon</desc><path fill="#6B6B6B" d="M12.344 11.458A5.28 5.28 0 0 0 14 7.526C14 4.483 11.391 2 8.051 2S2 4.483 2 7.527c0 3.051 2.712 5.526 6.059 5.526a6.6 6.6 0 0 0 1.758-.236q.255.223.554.414c.784.51 1.626.768 2.512.768a.37.37 0 0 0 .355-.214.37.37 0 0 0-.03-.384 4.7 4.7 0 0 1-.857-1.958v.014z"></path></svg><span>1</span></div></div></div></div></a></div></div></div><div class="ac r aeu aev"><div class=""><div><div class="bm" aria-hidden="false" aria-describedby="184" aria-labelledby="184"><div tabindex="-1" class="be"><span><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8445ef906ab&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40RobuRishabh%2Fbeginners-guide-to-linked-list-in-c-d8445ef906ab&amp;source=---read_next_recirc--eea0de9dcada----3-----------------bookmark_preview----f1290f04_c6ea_46e5_9658_cebaf8d1ef43--------------" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du nj aew" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="ty bh va dk dl aex aey aez"></div><a class="bf b bg ab bk rw uj uk ul nj ng um ev ew ex un uo up fa uq ur us ut uu fb fc fd bm fe ff" rel="noopener follow" href="https://medium.com/?source=post_page---read_next_recirc--eea0de9dcada---------------------------------------" data-discover="true"><div class="m ff">See more recommendations</div></a></div></div></div><div class="i l k"><div class="ty bh va vb"></div><div class="ac cb"><div class="ci bh hu hv hw hx"><div class="vc ac mg kx"><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Help</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Status</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/about?autoplay=1&amp;source=post_page-----eea0de9dcada---------------------------------------" data-discover="true"><p class="bf b dv ab du">About</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" rel="noopener follow" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----eea0de9dcada---------------------------------------" data-discover="true"><p class="bf b dv ab du">Careers</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b dv ab du">Press</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Blog</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Privacy</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Rules</p></a></div><div class="vd ve m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Terms</p></a></div><div class="vd m"><a class="ag ah ai fh ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----eea0de9dcada---------------------------------------" rel="noopener follow"><p class="bf b dv ab du">Text to speech</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250703-220655-90c293b367"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-eea0de9dcada","user-cc3e73266fd9","collection-7f60cf5620c9","group-sunsetLoNonMocUpsellExperimentGroup-group2"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"shouldFollowPostQueryEnabled":false,"sunsetLoNonMocUpsellExperimentGroup":"group2"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"24995fb6-8f91-429a-8989-95e60cdf7030","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-ce41c8af765ea7128cce181940736ad6-c3383659b9e66158-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"staticRouterContext":{"route":{"name":"ShowPostUnderCollection"},"statusCode":200},"toastQueue":[],"currentToast":null,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250703-220655-90c293b367","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","iosAppId":"828256236","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250703-220655-90c293b367","commit":"90c293b36735928fa9b2276c202191b153634418"}},"datacenter":"us"},"googleAdsCode":"AW-17106321204","googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"data-science\"})":{"__ref":"Collection:7f60cf5620c9"},"postResult({\"id\":\"eea0de9dcada\"})":{"__ref":"Post:eea0de9dcada"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","originalWidth":0,"originalHeight":0},"Collection:7f60cf5620c9":{"__typename":"Collection","id":"7f60cf5620c9","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"domain":null,"slug":"data-science","googleAnalyticsId":null,"name":"TDS Archive","avatar":{"__ref":"ImageMetadata:1*JEuS4KBdakUcjg9sC7Wo4A.png"},"description":"An archive of data science, data analytics, data engineering, machine learning, and artificial intelligence writing from the former Towards Data Science Medium publication.","subscriberCount":826355,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:7b4cc0efd235"}]},"isAuroraVisible":false,"tintColor":"#FF355876","viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:7f60cf5620c9-viewerId:lo_e1bd0aaae880"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:"}},"ImageMetadata:1*JEuS4KBdakUcjg9sC7Wo4A.png":{"__typename":"ImageMetadata","id":"1*JEuS4KBdakUcjg9sC7Wo4A.png"},"User:3da2be442381":{"__typename":"User","id":"3da2be442381","customDomainState":null,"hasSubdomain":false,"username":"jaingle77"},"Post:7b4cc0efd235":{"__typename":"Post","id":"7b4cc0efd235","firstPublishedAt":1738608884674,"creator":{"__ref":"User:3da2be442381"},"collection":{"__ref":"Collection:7f60cf5620c9"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fdiy-ai-how-to-build-a-linear-regression-model-from-scratch-7b4cc0efd235","sequence":null,"uniqueSlug":"diy-ai-how-to-build-a-linear-regression-model-from-scratch-7b4cc0efd235"},"LinkedAccounts:cc3e73266fd9":{"__typename":"LinkedAccounts","mastodon":null,"id":"cc3e73266fd9"},"NewsletterV3:98478bf32ac6":{"__typename":"NewsletterV3","id":"98478bf32ac6","type":"NEWSLETTER_TYPE_AUTHOR","slug":"cc3e73266fd9","name":"cc3e73266fd9","collection":null,"user":{"__ref":"User:cc3e73266fd9"}},"User:cc3e73266fd9":{"__typename":"User","id":"cc3e73266fd9","name":"Benny Friedman","username":"bennyfriedman","newsletterV3":{"__ref":"NewsletterV3:98478bf32ac6"},"linkedAccounts":{"__ref":"LinkedAccounts:cc3e73266fd9"},"isSuspended":false,"imageId":"2*-kLmQWFvXHMQAf6yZ88THA.png","customDomainState":null,"hasSubdomain":false,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":137,"followingCount":32,"collectionFollowingCount":2},"bio":"I manage the Engineering group of the Israeli Flipkart branch","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:cc3e73266fd9-viewerId:lo_e1bd0aaae880"},"twitterScreenName":""},"Paragraph:bc8a981a2f25_0":{"__typename":"Paragraph","id":"bc8a981a2f25_0","name":"0fe6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Creating a TensorFlow CNN in C++ (Part 2)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_1":{"__typename":"Paragraph","id":"bc8a981a2f25_1","name":"77c0","type":"H4","href":null,"layout":null,"metadata":null,"text":"In this post I’ll show how to create, train and test a Convolutional Neural Network using the TensorFlow C++ API","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_2":{"__typename":"Paragraph","id":"bc8a981a2f25_2","name":"5b1d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_3":{"__typename":"Paragraph","id":"bc8a981a2f25_3","name":"4411","type":"P","href":null,"layout":null,"metadata":null,"text":"In the last two years, Google’s TensorFlow has been gaining popularity. It is by far the most popular deep learning framework and together with Keras it is the most dominant framework.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":150,"end":173,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fdeep-learning-framework-power-scores-2018-23607ddf297a","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_4":{"__typename":"Paragraph","id":"bc8a981a2f25_4","name":"9814","type":"P","href":null,"layout":null,"metadata":null,"text":"Now with version 2, TensorFlow includes Keras built it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_5":{"__typename":"Paragraph","id":"bc8a981a2f25_5","name":"6872","type":"P","href":null,"layout":null,"metadata":null,"text":"However, when it comes to the C++ API, you can’t really find much information about using it. Most of the code samples and documentation are in Python. As I had mentioned in my previous posts, I want to allow C++ users, such as myself, to use the TensorFlow C++ API, which is a low-level API, which practically means that you have to put in more work to implement it. My post is here to help you.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_6":{"__typename":"Paragraph","id":"bc8a981a2f25_6","name":"c819","type":"P","href":null,"layout":null,"metadata":null,"text":"As I wrote in the past, I like C++. I have nothing against Python, but I would like to be able to build my models in C++ and also have the ecosystem of tools to help me debug and optimize it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_7":{"__typename":"Paragraph","id":"bc8a981a2f25_7","name":"2873","type":"P","href":null,"layout":null,"metadata":null,"text":"I read the documentation, and looked for code samples that will show me how to create a convolutional neural network. There are a couple of them, here and here which inspired me. That’s all!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":146,"end":150,"href":"https:\u002F\u002Fmedium.com\u002F@htmbx6\u002Fbuild-and-train-neural-network-with-tensorflow-c-f13f22d3c5b6","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":155,"end":159,"href":"https:\u002F\u002Fmatrices.io\u002Ftraining-a-deep-neural-network-using-only-tensorflow-c\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_8":{"__typename":"Paragraph","id":"bc8a981a2f25_8","name":"7e10","type":"P","href":null,"layout":null,"metadata":null,"text":"I had to reverse engineer some of the APIs and went through a lot of trial and errors until it worked.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_9":{"__typename":"Paragraph","id":"bc8a981a2f25_9","name":"3ccd","type":"P","href":null,"layout":null,"metadata":null,"text":"I hope this article will serve others who would like to start using the C++ API.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_10":{"__typename":"Paragraph","id":"bc8a981a2f25_10","name":"0d64","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m using XCode on MacOS, but I tried to build the code in a way that it will also work on Windows or Linux. I did not test that, so if you have any suggestions for a change, let me know.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_11":{"__typename":"Paragraph","id":"bc8a981a2f25_11","name":"513f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Setup","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_12":{"__typename":"Paragraph","id":"bc8a981a2f25_12","name":"558f","type":"P","href":null,"layout":null,"metadata":null,"text":"I am assuming you already have TensorFlow installed, and you have an XCode project ready to use it. If you need help with that, please read and follow my instructions here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":167,"end":171,"href":"https:\u002F\u002Fitnext.io\u002Fhow-to-use-your-c-muscle-using-tensorflow-2-0-and-xcode-without-using-bazel-builds-9dc82d5e7f80","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_13":{"__typename":"Paragraph","id":"bc8a981a2f25_13","name":"7367","type":"P","href":null,"layout":null,"metadata":null,"text":"As I wrote in part 1, the goal is to implement the AlexNet scaled-down version from part 4 of the famous article series by Arden Dertat.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":14,"end":20,"href":"https:\u002F\u002Fitnext.io\u002Fcreating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_14":{"__typename":"Paragraph","id":"bc8a981a2f25_14","name":"6954","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m also assuming you know the terminology of convolutional networks, if not, I suggest you read Arden’s articles.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_15":{"__typename":"Paragraph","id":"bc8a981a2f25_15","name":"8b60","type":"P","href":null,"layout":null,"metadata":null,"text":"To get the data for training, you will need to download the images from Kaggle.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":72,"end":78,"href":"https:\u002F\u002Fwww.kaggle.com\u002Fc\u002Fdogs-vs-cats","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_16":{"__typename":"Paragraph","id":"bc8a981a2f25_16","name":"3365","type":"P","href":null,"layout":null,"metadata":null,"text":"Download the small version from here. There are enough images there for our purpose.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":32,"end":36,"href":"https:\u002F\u002Fs3.amazonaws.com\u002Fimg-datasets\u002Fcats_and_dogs_small.zip","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_17":{"__typename":"Paragraph","id":"bc8a981a2f25_17","name":"c807","type":"P","href":null,"layout":null,"metadata":null,"text":"Extract the files and put them in a data folder under the project folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_18":{"__typename":"Paragraph","id":"bc8a981a2f25_18","name":"c494","type":"P","href":null,"layout":null,"metadata":null,"text":"It should be organized so you have three sub-folders for train, validation and test.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_19":{"__typename":"Paragraph","id":"bc8a981a2f25_19","name":"4218","type":"H3","href":null,"layout":null,"metadata":null,"text":"Code","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_20":{"__typename":"Paragraph","id":"bc8a981a2f25_20","name":"1e63","type":"P","href":null,"layout":null,"metadata":null,"text":"Code for this article can be found here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":35,"end":39,"href":"https:\u002F\u002Fgithub.com\u002Fbennyfri\u002FTFMacCpp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_21":{"__typename":"Paragraph","id":"bc8a981a2f25_21","name":"710b","type":"P","href":null,"layout":null,"metadata":null,"text":"There’s a main.cpp which drives the execution and two class files CatDogCNN.cpp and CatDogCNN.h which are the implementation of the network itself.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_22":{"__typename":"Paragraph","id":"bc8a981a2f25_22","name":"e29e","type":"P","href":null,"layout":null,"metadata":null,"text":"mainV1.cpp is the previous article code.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_23":{"__typename":"Paragraph","id":"bc8a981a2f25_23","name":"ebce","type":"P","href":null,"layout":null,"metadata":null,"text":"In general, when writing code for TensorFlow, it is wise to separate the creation of the graph from its actual running. This is due to the simple fact that you usually create the graph once and run it many times with different inputs. Even if you do not change the variables of the graph (like weights) there is no need to recreate the graph each time you want to run it, unless it is extremely simple, and the effort of separation is useless.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_24":{"__typename":"Paragraph","id":"bc8a981a2f25_24","name":"ab17","type":"H3","href":null,"layout":null,"metadata":null,"text":"Complete the data preparation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_25":{"__typename":"Paragraph","id":"bc8a981a2f25_25","name":"b453","type":"P","href":null,"layout":null,"metadata":null,"text":"CreateGraphForImage is a method that creates a graph similar to the one I showed in part 1.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":84,"end":90,"href":"https:\u002F\u002Fitnext.io\u002Fcreating-a-tensorflow-dnn-in-c-part-1-54ce69bbd586","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_26":{"__typename":"Paragraph","id":"bc8a981a2f25_26","name":"5c9f","type":"P","href":null,"layout":null,"metadata":null,"text":"It accepts a Boolean whether to unstack the image. Call it with false when you want to load only one image and true when you want to load a batch. This is since an additional dimension will be added when stacking a batch. But when you want to run the CNN with only one image, you need to have all 4 dimensions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_27":{"__typename":"Paragraph","id":"bc8a981a2f25_27","name":"653f","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that when changing from unstack to stack you have to re-create the graph.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_28":{"__typename":"Paragraph","id":"bc8a981a2f25_28","name":"b94b","type":"P","href":null,"layout":null,"metadata":null,"text":"ReadTensorFromImageFile is in charge of running the graph created by the previous method. You feed it with a full path name of a file and get a 3 or 4 dimensional Tensor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_29":{"__typename":"Paragraph","id":"bc8a981a2f25_29","name":"2f64","type":"P","href":null,"layout":null,"metadata":null,"text":"Code for both these methods is almost identical to the code in mainV1.cpp (article part 1).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_30":{"__typename":"Paragraph","id":"bc8a981a2f25_30","name":"7c9f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Handling folders and path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_31":{"__typename":"Paragraph","id":"bc8a981a2f25_31","name":"9642","type":"P","href":null,"layout":null,"metadata":null,"text":"ReadFileTensors deals with folders and the files. It accepts a base folder string and a vector of pairs of [sub-folder, label value].","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_32":{"__typename":"Paragraph","id":"bc8a981a2f25_32","name":"0d43","type":"P","href":null,"layout":null,"metadata":null,"text":"If you downloaded the images from Kaggle, you may have noticed that under train for example, there are two sub-folders cats and dogs. Label each one of them with a number and pass these pairs as input.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_33":{"__typename":"Paragraph","id":"bc8a981a2f25_33","name":"02b9","type":"P","href":null,"layout":null,"metadata":null,"text":"The return is a vector of pairs, each one is a Tensor (of an image) and a label.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_34":{"__typename":"Paragraph","id":"bc8a981a2f25_34","name":"e7f6","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is one way of calling it:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_35":{"__typename":"Paragraph","id":"bc8a981a2f25_35","name":"1b0a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"base_folder = \"\u002FUsers\u002Fbennyfriedman\u002FCode\u002FTF2example\u002FTF2example\u002Fdata\u002Fcats_and_dogs_small\u002Ftrain\";","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_36":{"__typename":"Paragraph","id":"bc8a981a2f25_36","name":"3bf6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003Cpair\u003CTensor, float\u003E\u003E all_files_tensors;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_37":{"__typename":"Paragraph","id":"bc8a981a2f25_37","name":"a7bb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model.ReadFileTensors(base_folder, {make_pair(\"cats\", 0), make_pair(\"dogs\", 1)}, all_files_tensors);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_38":{"__typename":"Paragraph","id":"bc8a981a2f25_38","name":"4918","type":"P","href":null,"layout":null,"metadata":null,"text":"We need to open a directory, read its files and go over them one by one.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_39":{"__typename":"Paragraph","id":"bc8a981a2f25_39","name":"186e","type":"P","href":null,"layout":null,"metadata":null,"text":"To join two path strings use io::JoinPath (include tensorflow\u002Fcore\u002Flib\u002Fio\u002Fpath.h)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_40":{"__typename":"Paragraph","id":"bc8a981a2f25_40","name":"5484","type":"PRE","href":null,"layout":null,"metadata":null,"text":"string folder_name = io::JoinPath(base_folder_name, “cats”);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_41":{"__typename":"Paragraph","id":"bc8a981a2f25_41","name":"05ae","type":"P","href":null,"layout":null,"metadata":null,"text":"To interact with the file system use “Env”. This is a utility class (not really documented) which gives you similar facilitation like C++17 std::filesystem.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_42":{"__typename":"Paragraph","id":"bc8a981a2f25_42","name":"b1d9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Env* penv = Env::Default();","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_43":{"__typename":"Paragraph","id":"bc8a981a2f25_43","name":"6ad6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_RETURN_IF_ERROR(penv-\u003EIsDirectory(folder_name));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_44":{"__typename":"Paragraph","id":"bc8a981a2f25_44","name":"e6ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003Cstring\u003E file_names;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_45":{"__typename":"Paragraph","id":"bc8a981a2f25_45","name":"e83c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_RETURN_IF_ERROR(penv-\u003EGetChildren(folder_name, &file_names));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_46":{"__typename":"Paragraph","id":"bc8a981a2f25_46","name":"fc4b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"for(string file: file_names)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_47":{"__typename":"Paragraph","id":"bc8a981a2f25_47","name":"6020","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_48":{"__typename":"Paragraph","id":"bc8a981a2f25_48","name":"aa0f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_49":{"__typename":"Paragraph","id":"bc8a981a2f25_49","name":"a683","type":"PRE","href":null,"layout":null,"metadata":null,"text":"}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_50":{"__typename":"Paragraph","id":"bc8a981a2f25_50","name":"706e","type":"P","href":null,"layout":null,"metadata":null,"text":"ReadFileTensors also shuffles the images in the vector, this is so we can feed different images while training (you do not want to feed all cats and then all dogs).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_51":{"__typename":"Paragraph","id":"bc8a981a2f25_51","name":"732e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Creating the batches","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_52":{"__typename":"Paragraph","id":"bc8a981a2f25_52","name":"6e2d","type":"P","href":null,"layout":null,"metadata":null,"text":"ReadBatches encapsulates all the logic main needs. You give it the base folder, the vectors of pair of sub-folders and labels and the size of a batch. In return you get two vectors of Tensors, one for images and one for labels. Each Tensor is a batch of images \u002F labels according to the size you passed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_53":{"__typename":"Paragraph","id":"bc8a981a2f25_53","name":"ef64","type":"P","href":null,"layout":null,"metadata":null,"text":"First it reads the folder and its sub-folders’ content into a vector. Next it does some calculations on how to split the batches. Then it breaks the pairs of Tensors and labels to create two Input vectors where each n-th element in the Tensor vector matches the n-th element in the labels vector.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_54":{"__typename":"Paragraph","id":"bc8a981a2f25_54","name":"f82d","type":"P","href":null,"layout":null,"metadata":null,"text":"To stack the two vectors, we create a tiny graph on the spot and run it for each iteration.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_55":{"__typename":"Paragraph","id":"bc8a981a2f25_55","name":"f659","type":"P","href":null,"layout":null,"metadata":null,"text":"The results are added to the output vectors.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_56":{"__typename":"Paragraph","id":"bc8a981a2f25_56","name":"910f","type":"P","href":null,"layout":null,"metadata":null,"text":"Note how Stack operation needs to get an InputList of image tensors to stack. The easiest way is to create a vector (or another container) and instantiate the InputList with it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_57":{"__typename":"Paragraph","id":"bc8a981a2f25_57","name":"1e89","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003CInput\u003E one_batch_image;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_58":{"__typename":"Paragraph","id":"bc8a981a2f25_58","name":"8b99","type":"PRE","href":null,"layout":null,"metadata":null,"text":"one_batch_image.push_back(Input(tensor));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_59":{"__typename":"Paragraph","id":"bc8a981a2f25_59","name":"c91f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002FAdd more tensors","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_60":{"__typename":"Paragraph","id":"bc8a981a2f25_60","name":"9ab9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"InputList one_batch_inputs(one_batch_image);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_61":{"__typename":"Paragraph","id":"bc8a981a2f25_61","name":"e649","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Scope root = Scope::NewRootScope();","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_62":{"__typename":"Paragraph","id":"bc8a981a2f25_62","name":"5027","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto stacked_images = Stack(root, one_batch_inputs);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_63":{"__typename":"Paragraph","id":"bc8a981a2f25_63","name":"678e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ClientSession session(root);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_64":{"__typename":"Paragraph","id":"bc8a981a2f25_64","name":"5637","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003CTensor\u003E out_tensors;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_65":{"__typename":"Paragraph","id":"bc8a981a2f25_65","name":"5590","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_CHECK_OK(session.Run({}, {stacked_images}, &out_tensors));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_66":{"__typename":"Paragraph","id":"bc8a981a2f25_66","name":"fe37","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002Fuse out_tensors[0]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_67":{"__typename":"Paragraph","id":"bc8a981a2f25_67","name":"257a","type":"P","href":null,"layout":null,"metadata":null,"text":"As written above, the tensors go in as 3 dimensional tensors and the batches that are created are 4 dimensional.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_68":{"__typename":"Paragraph","id":"bc8a981a2f25_68","name":"197e","type":"H3","href":null,"layout":null,"metadata":null,"text":"CNN graph","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_69":{"__typename":"Paragraph","id":"bc8a981a2f25_69","name":"0a30","type":"P","href":null,"layout":null,"metadata":null,"text":"Now comes the interesting part.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_70":{"__typename":"Paragraph","id":"bc8a981a2f25_70","name":"0dcb","type":"P","href":null,"layout":null,"metadata":null,"text":"We would like to create a model similar to AlexNet.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_71":{"__typename":"Paragraph","id":"bc8a981a2f25_71","name":"0ca8","type":"H4","href":null,"layout":null,"metadata":null,"text":"Input","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_72":{"__typename":"Paragraph","id":"bc8a981a2f25_72","name":"739e","type":"P","href":null,"layout":null,"metadata":null,"text":"First we want to define the input to the graph: we already know we need to feed a batch of images:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_73":{"__typename":"Paragraph","id":"bc8a981a2f25_73","name":"31d7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"input_batch_var = Placeholder(t_root.WithOpName(\"input\"), DT_FLOAT);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_74":{"__typename":"Paragraph","id":"bc8a981a2f25_74","name":"c832","type":"P","href":null,"layout":null,"metadata":null,"text":"A placeholder is like a function parameter. You specify its name and element type, but its shape is unknown at this time.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_75":{"__typename":"Paragraph","id":"bc8a981a2f25_75","name":"f56b","type":"P","href":null,"layout":null,"metadata":null,"text":"The variable getting the result from placeholder is a member of the CatDogCNN class type Output.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_76":{"__typename":"Paragraph","id":"bc8a981a2f25_76","name":"c73b","type":"P","href":null,"layout":null,"metadata":null,"text":"First we use it in the graph as input to the first layer and later we will need to specify it in the ClientSession Run command together with its value (the batch Tensor).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_77":{"__typename":"Paragraph","id":"bc8a981a2f25_77","name":"a25c","type":"P","href":null,"layout":null,"metadata":null,"text":"Next there are a couple of placeholders which I will explain later.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_78":{"__typename":"Paragraph","id":"bc8a981a2f25_78","name":"9c7d","type":"P","href":null,"layout":null,"metadata":null,"text":"Unlike in the usual Python Keras networks, the C++ layers are a composition of Operations (Google calls them low level API). To know what layer each operation belongs to, we create a sub-scope per layer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_79":{"__typename":"Paragraph","id":"bc8a981a2f25_79","name":"55f6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Scope scope_conv1 = t_root.NewSubScope(\"Conv1_layer\");","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_80":{"__typename":"Paragraph","id":"bc8a981a2f25_80","name":"3d6a","type":"P","href":null,"layout":null,"metadata":null,"text":"The operations will be created with this scope object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_81":{"__typename":"Paragraph","id":"bc8a981a2f25_81","name":"99f3","type":"H4","href":null,"layout":null,"metadata":null,"text":"Convolution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_82":{"__typename":"Paragraph","id":"bc8a981a2f25_82","name":"226e","type":"P","href":null,"layout":null,"metadata":null,"text":"The first layer is a Convolution layer, so we need to define 4 parameters: filter height and width and in and out channels. In addition, we have the activation function (Relu) and a MaxPool operation that follows.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_83":{"__typename":"Paragraph","id":"bc8a981a2f25_83","name":"cef1","type":"P","href":null,"layout":null,"metadata":null,"text":"We have 4 Conv layers, so I created a function to create a generic one that includes these operations:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_84":{"__typename":"Paragraph","id":"bc8a981a2f25_84","name":"96e2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Input CatDogCNN::AddConvLayer(string idx, Scope scope, int in_channels, int out_channels, int filter_side, Input input)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_85":{"__typename":"Paragraph","id":"bc8a981a2f25_85","name":"4ada","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_86":{"__typename":"Paragraph","id":"bc8a981a2f25_86","name":"f147","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TensorShape sp({filter_side, filter_side, in_channels, out_channels});","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_87":{"__typename":"Paragraph","id":"bc8a981a2f25_87","name":"9e41","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_vars[\"W\"+idx] = Variable(scope.WithOpName(\"W\"), sp, DT_FLOAT);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_88":{"__typename":"Paragraph","id":"bc8a981a2f25_88","name":"1275","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_shapes[\"W\"+idx] = sp;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_89":{"__typename":"Paragraph","id":"bc8a981a2f25_89","name":"8cc0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_assigns[\"W\"+idx+\"_assign\"] = Assign(scope.WithOpName(\"W_assign\"), m_vars[\"W\"+idx], XavierInit(scope, in_channels, out_channels, filter_side));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_90":{"__typename":"Paragraph","id":"bc8a981a2f25_90","name":"02eb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sp = {out_channels};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_91":{"__typename":"Paragraph","id":"bc8a981a2f25_91","name":"e144","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_vars[\"B\"+idx] = Variable(scope.WithOpName(\"B\"), sp, DT_FLOAT);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_92":{"__typename":"Paragraph","id":"bc8a981a2f25_92","name":"16b7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_shapes[\"B\"+idx] = sp;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_93":{"__typename":"Paragraph","id":"bc8a981a2f25_93","name":"960c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"m_assigns[\"B\"+idx+\"_assign\"] = Assign(scope.WithOpName(\"B_assign\"), m_vars[\"B\"+idx], Input::Initializer(0.f, sp));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_94":{"__typename":"Paragraph","id":"bc8a981a2f25_94","name":"ff1f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto conv = Conv2D(scope.WithOpName(\"Conv\"), input, m_vars[\"W\"+idx], {1, 1, 1, 1}, \"SAME\");","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_95":{"__typename":"Paragraph","id":"bc8a981a2f25_95","name":"ef79","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto bias = BiasAdd(scope.WithOpName(\"Bias\"), conv, m_vars[\"B\"+idx]);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_96":{"__typename":"Paragraph","id":"bc8a981a2f25_96","name":"074b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto relu = Relu(scope.WithOpName(\"Relu\"), bias);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_97":{"__typename":"Paragraph","id":"bc8a981a2f25_97","name":"83bd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"return MaxPool(scope.WithOpName(\"Pool\"), relu, {1, 2, 2, 1}, {1, 2, 2, 1}, \"SAME\");","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_98":{"__typename":"Paragraph","id":"bc8a981a2f25_98","name":"2b8e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_99":{"__typename":"Paragraph","id":"bc8a981a2f25_99","name":"4cb0","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s review the code:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_100":{"__typename":"Paragraph","id":"bc8a981a2f25_100","name":"8b24","type":"P","href":null,"layout":null,"metadata":null,"text":"AddConvLayer gets an index string (to distinguish between layers), the sub-scope, in and out channels, a filter size (we assume same height and width) and Input input.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_101":{"__typename":"Paragraph","id":"bc8a981a2f25_101","name":"f00a","type":"P","href":null,"layout":null,"metadata":null,"text":"For the first layer in channels is the number of colors the image has (3 colors) and the input is the image Tensor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_102":{"__typename":"Paragraph","id":"bc8a981a2f25_102","name":"7250","type":"P","href":null,"layout":null,"metadata":null,"text":"The Conv2D operation needs a Tensor variable which holds the different filters (32 in the first layer). This variable will be changed within each step when the network in training.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_103":{"__typename":"Paragraph","id":"bc8a981a2f25_103","name":"9390","type":"P","href":null,"layout":null,"metadata":null,"text":"For that reason, there is a member map m_vars that holds these variables as well as the biases. In addition, we need to store the shapes of these variables (m_shapes map) and we also need to initialize these variable with values (similar to Python variable initializer) — these operations are stored in m_assigns. Xavier initialization is popular these days, so I’ve implemented XavierInit to do that for Conv and Dense.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_104":{"__typename":"Paragraph","id":"bc8a981a2f25_104","name":"c468","type":"P","href":null,"layout":null,"metadata":null,"text":"After the Conv2D there is a call to BiasAdd to add the bias (which is initialized to 0).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_105":{"__typename":"Paragraph","id":"bc8a981a2f25_105","name":"6afe","type":"P","href":null,"layout":null,"metadata":null,"text":"Next is a call to Relu followed by a call to MaxPool.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_106":{"__typename":"Paragraph","id":"bc8a981a2f25_106","name":"7ef0","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that for MaxPool in the Python Keras version, you only need to specify the window size with its two dimensions (e.g. 2, 2). Here we need to supply two shapes of 4 dimensions (window size and strides). To halve the size of the image in each layer, you must put 1, 2, 2, 1 in both window size and strides.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_107":{"__typename":"Paragraph","id":"bc8a981a2f25_107","name":"6379","type":"P","href":null,"layout":null,"metadata":null,"text":"Also note that in the CreateGraphForCNN function I track the sizes of the in and out channels since they have to match between the layers.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_108":{"__typename":"Paragraph","id":"bc8a981a2f25_108","name":"ce96","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, since there is no way of getting the shape of the tensors coming out of operations (in is only known in runtime) we have to calculate the image size in each step.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_109":{"__typename":"Paragraph","id":"bc8a981a2f25_109","name":"b8c0","type":"H4","href":null,"layout":null,"metadata":null,"text":"Flat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_110":{"__typename":"Paragraph","id":"bc8a981a2f25_110","name":"3344","type":"P","href":null,"layout":null,"metadata":null,"text":"Flattening means we will have only two dimensions, the batch and the flat data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_111":{"__typename":"Paragraph","id":"bc8a981a2f25_111","name":"6deb","type":"P","href":null,"layout":null,"metadata":null,"text":"To do that, we need to reshape the Tensor. Since I don’t want to hard code the batch size (I do not know whether it will be batched or not), I have to know the size of the flat data. That’s why I have these calculations done through the layers until we get flat_len.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_112":{"__typename":"Paragraph","id":"bc8a981a2f25_112","name":"0156","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto flat = Reshape(flatten, pool4, {-1, flat_len});","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_113":{"__typename":"Paragraph","id":"bc8a981a2f25_113","name":"6b2f","type":"P","href":null,"layout":null,"metadata":null,"text":"In Reshape you are allowed to pass -1 in one of the dimensions, so it will be automatically calculated. Reshape does not add data, it only changes the way it is organized in.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_114":{"__typename":"Paragraph","id":"bc8a981a2f25_114","name":"f364","type":"H4","href":null,"layout":null,"metadata":null,"text":"Dropout","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_115":{"__typename":"Paragraph","id":"bc8a981a2f25_115","name":"6db8","type":"P","href":null,"layout":null,"metadata":null,"text":"This layer is in charge of dropping random neurons so the network will not overfit.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_116":{"__typename":"Paragraph","id":"bc8a981a2f25_116","name":"c250","type":"P","href":null,"layout":null,"metadata":null,"text":"We create a new tensor with same shape and fill it with either 0 or 1 randomly with a ratio according to the drop rate and multiply our data by it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_117":{"__typename":"Paragraph","id":"bc8a981a2f25_117","name":"bff1","type":"P","href":null,"layout":null,"metadata":null,"text":"However, when you want to validate or predict, you do not want to drop out neurons.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_118":{"__typename":"Paragraph","id":"bc8a981a2f25_118","name":"b8ef","type":"P","href":null,"layout":null,"metadata":null,"text":"The logical way to achieve that would be to put a condition in the graph. There are operations that support that in a very cumbersome way (Switch and Merge) but they do not support backpropagation in C++ so we can’t use them.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_119":{"__typename":"Paragraph","id":"bc8a981a2f25_119","name":"e44c","type":"P","href":null,"layout":null,"metadata":null,"text":"Instead I introduced two more input parameters to the network drop_rate and skip_drop so for example if you pass 0.4 and 0 respectively, you get 40% drop. If you pass 1 and 1 you get no drops.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_120":{"__typename":"Paragraph","id":"bc8a981a2f25_120","name":"b624","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Scope dropout = t_root.NewSubScope(\"Dropout_layer\");","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_121":{"__typename":"Paragraph","id":"bc8a981a2f25_121","name":"e209","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto rand = RandomUniform(dropout, Shape(dropout, flat), DT_FLOAT);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_122":{"__typename":"Paragraph","id":"bc8a981a2f25_122","name":"aa26","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002Fbinary = floor(rand + (1 - drop_rate) + skip_drop)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_123":{"__typename":"Paragraph","id":"bc8a981a2f25_123","name":"4e51","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto binary = Floor(dropout, Add(dropout, rand, Add(dropout, Sub(dropout, 1.f, drop_rate_var), skip_drop_var)));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_124":{"__typename":"Paragraph","id":"bc8a981a2f25_124","name":"b9fe","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto after_drop = Multiply(dropout.WithOpName(\"dropout\"), Div(dropout, flat, drop_rate_var), binary)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_125":{"__typename":"Paragraph","id":"bc8a981a2f25_125","name":"d37b","type":"P","href":null,"layout":null,"metadata":null,"text":"When dropping, we increase the values of the remaining neurons by dividing by the drop rate.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_126":{"__typename":"Paragraph","id":"bc8a981a2f25_126","name":"b809","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that when skip_drop is 1, the floor will turn “binary” into all ones.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_127":{"__typename":"Paragraph","id":"bc8a981a2f25_127","name":"dcf9","type":"H4","href":null,"layout":null,"metadata":null,"text":"Fully Connected (Dense)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_128":{"__typename":"Paragraph","id":"bc8a981a2f25_128","name":"1656","type":"P","href":null,"layout":null,"metadata":null,"text":"Next are three dense layers.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_129":{"__typename":"Paragraph","id":"bc8a981a2f25_129","name":"0349","type":"P","href":null,"layout":null,"metadata":null,"text":"Dense is based on multiplying by weights and adding bias. We keep the variables in the map and do the same for shapes and assigns.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_130":{"__typename":"Paragraph","id":"bc8a981a2f25_130","name":"9eb8","type":"P","href":null,"layout":null,"metadata":null,"text":"We also initialize the weights with Xavier init and the biases with 0.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_131":{"__typename":"Paragraph","id":"bc8a981a2f25_131","name":"70ce","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that in the last dense layer, we need to skip the Relu activation (for that we have bActivation).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_132":{"__typename":"Paragraph","id":"bc8a981a2f25_132","name":"6f79","type":"H4","href":null,"layout":null,"metadata":null,"text":"Binary classification","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_133":{"__typename":"Paragraph","id":"bc8a981a2f25_133","name":"a4fc","type":"P","href":null,"layout":null,"metadata":null,"text":"The last dense layer reduced the size to 1 (over batch size). This is called the logits.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_134":{"__typename":"Paragraph","id":"bc8a981a2f25_134","name":"b30f","type":"P","href":null,"layout":null,"metadata":null,"text":"To make logits a 0 (for cat) or 1 (for dog) we call Sigmoid and return this result out.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_135":{"__typename":"Paragraph","id":"bc8a981a2f25_135","name":"2520","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s how the network looks like when turning on TensorBoard (see part 1 for details):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*R6INLxmJU9ALePGUAYuMNQ.png":{"__typename":"ImageMetadata","id":"1*R6INLxmJU9ALePGUAYuMNQ.png","originalHeight":2103,"originalWidth":1335,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:bc8a981a2f25_136":{"__typename":"Paragraph","id":"bc8a981a2f25_136","name":"1580","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*R6INLxmJU9ALePGUAYuMNQ.png"},"text":"The CNN before we add optimization","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_137":{"__typename":"Paragraph","id":"bc8a981a2f25_137","name":"4ac8","type":"P","href":null,"layout":null,"metadata":null,"text":"I opened one of the sub-scopes so you can see the low-level operations in the fourth convolution layer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_138":{"__typename":"Paragraph","id":"bc8a981a2f25_138","name":"ba75","type":"H4","href":null,"layout":null,"metadata":null,"text":"Optimization graph (backpropagation)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_139":{"__typename":"Paragraph","id":"bc8a981a2f25_139","name":"4302","type":"P","href":null,"layout":null,"metadata":null,"text":"This is encapsulated in the CreateOptimizationGraph function. It is not a separate graph, but additional nodes in the same graph (same t_root main scope).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_140":{"__typename":"Paragraph","id":"bc8a981a2f25_140","name":"bebd","type":"P","href":null,"layout":null,"metadata":null,"text":"We start with a placeholder for the labels. If the image tensors were the x, this is the y.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_141":{"__typename":"Paragraph","id":"bc8a981a2f25_141","name":"24e5","type":"P","href":null,"layout":null,"metadata":null,"text":"Next we calculate the loss. This is a classification problem, so we should use cross entropy however I’m not sure how to use the SoftmaxCrossEntropyWithLogits operation and could not find any meaningful information on it, so I had to use the regular mean square diff method.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_142":{"__typename":"Paragraph","id":"bc8a981a2f25_142","name":"f5d4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"input_labels_var = Placeholder(t_root.WithOpName(\"inputL\"), DT_FLOAT);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_143":{"__typename":"Paragraph","id":"bc8a981a2f25_143","name":"41b1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Scope scope_loss = t_root.NewSubScope(\"Loss_scope\");","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_144":{"__typename":"Paragraph","id":"bc8a981a2f25_144","name":"3c57","type":"PRE","href":null,"layout":null,"metadata":null,"text":"out_loss_var = Mean(scope_loss.WithOpName(\"Loss\"), SquaredDifference(scope_loss, out_classification, input_labels_var), {0});","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_145":{"__typename":"Paragraph","id":"bc8a981a2f25_145","name":"e0fd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_CHECK_OK(scope_loss.status());","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_146":{"__typename":"Paragraph","id":"bc8a981a2f25_146","name":"6be2","type":"P","href":null,"layout":null,"metadata":null,"text":"Next I collect all the weights and biases and send them together with the loss to the magical API call AddSymbolicGradients. This marvelous function is not an operation. It takes a graph (by its associated scope), adds all the relevant backpropagating operations and returns a vector of gradient with the same size as the number of weights and biases.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_147":{"__typename":"Paragraph","id":"bc8a981a2f25_147","name":"8831","type":"P","href":null,"layout":null,"metadata":null,"text":"Then we use the ApplyAdam on each variable from the weights and biases with its respective gradient.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_148":{"__typename":"Paragraph","id":"bc8a981a2f25_148","name":"306f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auto adam = ApplyAdam(t_root, i.second, m_var, v_var, 0.f, 0.f, learning_rate, 0.9f, 0.999f, 0.00000001f, {grad_outputs[index]});","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_149":{"__typename":"Paragraph","id":"bc8a981a2f25_149","name":"ec69","type":"PRE","href":null,"layout":null,"metadata":null,"text":"v_out_grads.push_back(adam.operation);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_150":{"__typename":"Paragraph","id":"bc8a981a2f25_150","name":"035f","type":"P","href":null,"layout":null,"metadata":null,"text":"For some reason, m_var and v_var have to be variables (they cannot be constant).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_151":{"__typename":"Paragraph","id":"bc8a981a2f25_151","name":"c955","type":"P","href":null,"layout":null,"metadata":null,"text":"The most important variable you pass to ApplyAdam is the learning rate. I can’t stress enough how important this value is. I started with 0.001 (from the python version) and could not stop puzzling over why the loss did not converge. Eventually I realized the optimization function jumps too long in between peaks. Only after a few days when I changed it to 0.0001 it started working. You can try different values to see how it works in your case.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_152":{"__typename":"Paragraph","id":"bc8a981a2f25_152","name":"15f9","type":"P","href":null,"layout":null,"metadata":null,"text":"You can change the other values ApplyAdam is getting as well, though I’m not sure what’s the impact of that.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_153":{"__typename":"Paragraph","id":"bc8a981a2f25_153","name":"ee44","type":"P","href":null,"layout":null,"metadata":null,"text":"Now the TensorBoard image looks “a bit” different:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LwH9Ap0jZH1YgrpjJzDMjA.png":{"__typename":"ImageMetadata","id":"1*LwH9Ap0jZH1YgrpjJzDMjA.png","originalHeight":2224,"originalWidth":6165,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:bc8a981a2f25_154":{"__typename":"Paragraph","id":"bc8a981a2f25_154","name":"ff4c","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*LwH9Ap0jZH1YgrpjJzDMjA.png"},"text":"The CNN with optimization","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_155":{"__typename":"Paragraph","id":"bc8a981a2f25_155","name":"6da3","type":"H4","href":null,"layout":null,"metadata":null,"text":"Initialization","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_156":{"__typename":"Paragraph","id":"bc8a981a2f25_156","name":"c657","type":"P","href":null,"layout":null,"metadata":null,"text":"I have already mentioned the need to initialize all the variables with the Assign operation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_157":{"__typename":"Paragraph","id":"bc8a981a2f25_157","name":"7e8f","type":"P","href":null,"layout":null,"metadata":null,"text":"We collect all the m_assigns elements (also the ones we added for ApplyAdam) into a vector and run them in the created session.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_158":{"__typename":"Paragraph","id":"bc8a981a2f25_158","name":"1212","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003COutput\u003E ops_to_run;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_159":{"__typename":"Paragraph","id":"bc8a981a2f25_159","name":"8edc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"for(pair\u003Cstring, Output\u003E i: m_assigns)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_160":{"__typename":"Paragraph","id":"bc8a981a2f25_160","name":"1e06","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ops_to_run.push_back(i.second);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_161":{"__typename":"Paragraph","id":"bc8a981a2f25_161","name":"2931","type":"PRE","href":null,"layout":null,"metadata":null,"text":"t_session = unique_ptr\u003CClientSession\u003E(new ClientSession(t_root));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_162":{"__typename":"Paragraph","id":"bc8a981a2f25_162","name":"e723","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_CHECK_OK(t_session-\u003ERun(ops_to_run, nullptr));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_163":{"__typename":"Paragraph","id":"bc8a981a2f25_163","name":"1bf1","type":"P","href":null,"layout":null,"metadata":null,"text":"Leave the comments around the summary file writer code and use it only when you want to generate a new graph for TensorBoard visualization.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_164":{"__typename":"Paragraph","id":"bc8a981a2f25_164","name":"19cc","type":"H3","href":null,"layout":null,"metadata":null,"text":"Training","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_165":{"__typename":"Paragraph","id":"bc8a981a2f25_165","name":"ae87","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s go back to main: we constructed an instance of the CatDogCNN class, created the graphs, loaded the images and ran initialization.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_166":{"__typename":"Paragraph","id":"bc8a981a2f25_166","name":"df3d","type":"P","href":null,"layout":null,"metadata":null,"text":"It is time for the main epoch \u002F step loops.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_167":{"__typename":"Paragraph","id":"bc8a981a2f25_167","name":"10a7","type":"P","href":null,"layout":null,"metadata":null,"text":"An epoch is a run through all the training data. A step is a single run of a batch of images.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_168":{"__typename":"Paragraph","id":"bc8a981a2f25_168","name":"8475","type":"P","href":null,"layout":null,"metadata":null,"text":"We define the number of epochs, loop through them, and then loop through the batches.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_169":{"__typename":"Paragraph","id":"bc8a981a2f25_169","name":"7bd4","type":"P","href":null,"layout":null,"metadata":null,"text":"In each iteration, we call TrainCNN, we call ValidateCNN and we do some calculation to check the performance of the network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_170":{"__typename":"Paragraph","id":"bc8a981a2f25_170","name":"83b9","type":"P","href":null,"layout":null,"metadata":null,"text":"TrainCNN gets a batch of images, a batch of labels (corresponding these images) and returns results and loss.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_171":{"__typename":"Paragraph","id":"bc8a981a2f25_171","name":"c06b","type":"P","href":null,"layout":null,"metadata":null,"text":"The function first runs the batch:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_172":{"__typename":"Paragraph","id":"bc8a981a2f25_172","name":"6190","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003CTensor\u003E out_tensors;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_173":{"__typename":"Paragraph","id":"bc8a981a2f25_173","name":"2fb3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002FInputs: batch of images, labels, drop rate and do not skip drop.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_174":{"__typename":"Paragraph","id":"bc8a981a2f25_174","name":"617b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002FExtract: Loss and result. Run also: Apply Adam commands","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_175":{"__typename":"Paragraph","id":"bc8a981a2f25_175","name":"aa93","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_CHECK_OK(t_session-\u003ERun({{input_batch_var, image_batch}, {input_labels_var, label_batch}, {drop_rate_var, 0.5f}, {skip_drop_var, 0.f}}, {out_loss_var, out_classification}, v_out_grads, &out_tensors));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_176":{"__typename":"Paragraph","id":"bc8a981a2f25_176","name":"5b03","type":"P","href":null,"layout":null,"metadata":null,"text":"Then it calculates accuracy. Notice the usage of Tensor methods to extract the data: out_tensors[0].scalar\u003Cfloat\u003E()(0) to get a scalar and out_tensors[1].matrix\u003Cfloat\u003E() to get a matrix (which is almost like a vector of vectors).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_177":{"__typename":"Paragraph","id":"bc8a981a2f25_177","name":"c57b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Validation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_178":{"__typename":"Paragraph","id":"bc8a981a2f25_178","name":"2a59","type":"P","href":null,"layout":null,"metadata":null,"text":"Validation is important due to the fact we run through the network images that network never saw. If in each epoch we get better performance we are not over fitting.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_179":{"__typename":"Paragraph","id":"bc8a981a2f25_179","name":"d323","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vector\u003CTensor\u003E out_tensors;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_180":{"__typename":"Paragraph","id":"bc8a981a2f25_180","name":"58c9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002FInputs: batch of images, drop rate 1 and skip drop.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_181":{"__typename":"Paragraph","id":"bc8a981a2f25_181","name":"b691","type":"PRE","href":null,"layout":null,"metadata":null,"text":"TF_CHECK_OK(t_session-\u003ERun({{input_batch_var, image_batch}, {drop_rate_var, 1.f}, {skip_drop_var, 1.f}}, {out_classification}, &out_tensors));","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_182":{"__typename":"Paragraph","id":"bc8a981a2f25_182","name":"4f56","type":"P","href":null,"layout":null,"metadata":null,"text":"Note the differences: we skip the dropout (see above for the explanation), we do not evaluate loss and we do not run the gradients.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_183":{"__typename":"Paragraph","id":"bc8a981a2f25_183","name":"ffe9","type":"P","href":null,"layout":null,"metadata":null,"text":"The output console looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_184":{"__typename":"Paragraph","id":"bc8a981a2f25_184","name":"a39d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Epoch 1\u002F20:....................................................................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_185":{"__typename":"Paragraph","id":"bc8a981a2f25_185","name":"b708","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Validation:..................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_186":{"__typename":"Paragraph","id":"bc8a981a2f25_186","name":"5978","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Time: 74 seconds Loss: 0.243231 Results accuracy: 0.561 Validation accuracy: 0.642","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_187":{"__typename":"Paragraph","id":"bc8a981a2f25_187","name":"834a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Epoch 2\u002F20:....................................................................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_188":{"__typename":"Paragraph","id":"bc8a981a2f25_188","name":"6a9f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Validation:..................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_189":{"__typename":"Paragraph","id":"bc8a981a2f25_189","name":"0026","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Time: 72 seconds Loss: 0.203312 Results accuracy: 0.6875 Validation accuracy: 0.692","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_190":{"__typename":"Paragraph","id":"bc8a981a2f25_190","name":"a09b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"***","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_191":{"__typename":"Paragraph","id":"bc8a981a2f25_191","name":"689c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Epoch 20\u002F20:....................................................................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_192":{"__typename":"Paragraph","id":"bc8a981a2f25_192","name":"c35b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Validation:..................................................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_193":{"__typename":"Paragraph","id":"bc8a981a2f25_193","name":"52e2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Time: 73 seconds Loss: 0.041021 Results accuracy: 0.956 Validation accuracy: 0.742","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_194":{"__typename":"Paragraph","id":"bc8a981a2f25_194","name":"d707","type":"P","href":null,"layout":null,"metadata":null,"text":"The loss is constantly going down, the results accuracy is going us to 95% and the validation accuracy is going up to 75%.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_195":{"__typename":"Paragraph","id":"bc8a981a2f25_195","name":"220b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Testing","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_196":{"__typename":"Paragraph","id":"bc8a981a2f25_196","name":"19d4","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s test the trained network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_197":{"__typename":"Paragraph","id":"bc8a981a2f25_197","name":"9a56","type":"P","href":null,"layout":null,"metadata":null,"text":"For that we need to recreate the load image graph so it will not unstack.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_198":{"__typename":"Paragraph","id":"bc8a981a2f25_198","name":"b6dc","type":"P","href":null,"layout":null,"metadata":null,"text":"Then we call ReadFileTensors to load the images in the test sub-folder. Lastly we run a loop of a few of them to see the performance of the network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_199":{"__typename":"Paragraph","id":"bc8a981a2f25_199","name":"7ae7","type":"P","href":null,"layout":null,"metadata":null,"text":"Predict is similar to validation, though it runs a single image.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_200":{"__typename":"Paragraph","id":"bc8a981a2f25_200","name":"9bab","type":"P","href":null,"layout":null,"metadata":null,"text":"The output console looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_201":{"__typename":"Paragraph","id":"bc8a981a2f25_201","name":"7e52","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Test number: 1 predicted: 0 actual is: 0","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_202":{"__typename":"Paragraph","id":"bc8a981a2f25_202","name":"0629","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Test number: 2 predicted: 1 actual is: 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_203":{"__typename":"Paragraph","id":"bc8a981a2f25_203","name":"588c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"***","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_204":{"__typename":"Paragraph","id":"bc8a981a2f25_204","name":"98c9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Test number: 20 predicted: 0 actual is: 0","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_205":{"__typename":"Paragraph","id":"bc8a981a2f25_205","name":"2a38","type":"PRE","href":null,"layout":null,"metadata":null,"text":"total successes: 16 out of 20","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_206":{"__typename":"Paragraph","id":"bc8a981a2f25_206","name":"a768","type":"P","href":null,"layout":null,"metadata":null,"text":"80% accuracy. There is some room for improvement, but we got better results than Arden got on his network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_207":{"__typename":"Paragraph","id":"bc8a981a2f25_207","name":"21e2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Summary","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_208":{"__typename":"Paragraph","id":"bc8a981a2f25_208","name":"7d80","type":"P","href":null,"layout":null,"metadata":null,"text":"We saw how a CNN can be implemented, trained and tested using only C++ and the TensorFlow API.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_209":{"__typename":"Paragraph","id":"bc8a981a2f25_209","name":"c75a","type":"P","href":null,"layout":null,"metadata":null,"text":"We saw how to prepare data (images for training, validation and test) and how to batch them so that we can feed these batches to the TensorFlow low level API.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_210":{"__typename":"Paragraph","id":"bc8a981a2f25_210","name":"eece","type":"P","href":null,"layout":null,"metadata":null,"text":"We implemented gradients, and other optimization methods.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_211":{"__typename":"Paragraph","id":"bc8a981a2f25_211","name":"c078","type":"P","href":null,"layout":null,"metadata":null,"text":"We got good results, but there is more work to be done.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_212":{"__typename":"Paragraph","id":"bc8a981a2f25_212","name":"c1b4","type":"P","href":null,"layout":null,"metadata":null,"text":"Next I’m planning to do some improvements.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_213":{"__typename":"Paragraph","id":"bc8a981a2f25_213","name":"b37e","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see in the console output, I’m running on my local MacBook Pro CPU and it takes a long time to run…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_214":{"__typename":"Paragraph","id":"bc8a981a2f25_214","name":"0f17","type":"P","href":null,"layout":null,"metadata":null,"text":"I’m planning to implement freeze model function and GPU usage to speed things up.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:bc8a981a2f25_215":{"__typename":"Paragraph","id":"bc8a981a2f25_215","name":"142e","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, I’ll see if I can do some image augmentation to create more data for the training.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:7f60cf5620c9-viewerId:lo_e1bd0aaae880":{"__typename":"CollectionViewerEdge","id":"collectionId:7f60cf5620c9-viewerId:lo_e1bd0aaae880","isEditor":false,"isMuting":false},"UserViewerEdge:userId:cc3e73266fd9-viewerId:lo_e1bd0aaae880":{"__typename":"UserViewerEdge","id":"userId:cc3e73266fd9-viewerId:lo_e1bd0aaae880","isMuting":false},"PostViewerEdge:postId:eea0de9dcada-viewerId:lo_e1bd0aaae880":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:eea0de9dcada-viewerId:lo_e1bd0aaae880"},"Tag:machine-learning":{"__typename":"Tag","id":"machine-learning","displayTitle":"Machine Learning","normalizedTagSlug":"machine-learning"},"Tag:cplusplus":{"__typename":"Tag","id":"cplusplus","displayTitle":"Cplusplus","normalizedTagSlug":"cplusplus"},"Post:eea0de9dcada":{"__typename":"Post","id":"eea0de9dcada","collection":{"__ref":"Collection:7f60cf5620c9"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fsearch.brave.com\u002F\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"b1ff","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:bc8a981a2f25_0"},{"__ref":"Paragraph:bc8a981a2f25_1"},{"__ref":"Paragraph:bc8a981a2f25_2"},{"__ref":"Paragraph:bc8a981a2f25_3"},{"__ref":"Paragraph:bc8a981a2f25_4"},{"__ref":"Paragraph:bc8a981a2f25_5"},{"__ref":"Paragraph:bc8a981a2f25_6"},{"__ref":"Paragraph:bc8a981a2f25_7"},{"__ref":"Paragraph:bc8a981a2f25_8"},{"__ref":"Paragraph:bc8a981a2f25_9"},{"__ref":"Paragraph:bc8a981a2f25_10"},{"__ref":"Paragraph:bc8a981a2f25_11"},{"__ref":"Paragraph:bc8a981a2f25_12"},{"__ref":"Paragraph:bc8a981a2f25_13"},{"__ref":"Paragraph:bc8a981a2f25_14"},{"__ref":"Paragraph:bc8a981a2f25_15"},{"__ref":"Paragraph:bc8a981a2f25_16"},{"__ref":"Paragraph:bc8a981a2f25_17"},{"__ref":"Paragraph:bc8a981a2f25_18"},{"__ref":"Paragraph:bc8a981a2f25_19"},{"__ref":"Paragraph:bc8a981a2f25_20"},{"__ref":"Paragraph:bc8a981a2f25_21"},{"__ref":"Paragraph:bc8a981a2f25_22"},{"__ref":"Paragraph:bc8a981a2f25_23"},{"__ref":"Paragraph:bc8a981a2f25_24"},{"__ref":"Paragraph:bc8a981a2f25_25"},{"__ref":"Paragraph:bc8a981a2f25_26"},{"__ref":"Paragraph:bc8a981a2f25_27"},{"__ref":"Paragraph:bc8a981a2f25_28"},{"__ref":"Paragraph:bc8a981a2f25_29"},{"__ref":"Paragraph:bc8a981a2f25_30"},{"__ref":"Paragraph:bc8a981a2f25_31"},{"__ref":"Paragraph:bc8a981a2f25_32"},{"__ref":"Paragraph:bc8a981a2f25_33"},{"__ref":"Paragraph:bc8a981a2f25_34"},{"__ref":"Paragraph:bc8a981a2f25_35"},{"__ref":"Paragraph:bc8a981a2f25_36"},{"__ref":"Paragraph:bc8a981a2f25_37"},{"__ref":"Paragraph:bc8a981a2f25_38"},{"__ref":"Paragraph:bc8a981a2f25_39"},{"__ref":"Paragraph:bc8a981a2f25_40"},{"__ref":"Paragraph:bc8a981a2f25_41"},{"__ref":"Paragraph:bc8a981a2f25_42"},{"__ref":"Paragraph:bc8a981a2f25_43"},{"__ref":"Paragraph:bc8a981a2f25_44"},{"__ref":"Paragraph:bc8a981a2f25_45"},{"__ref":"Paragraph:bc8a981a2f25_46"},{"__ref":"Paragraph:bc8a981a2f25_47"},{"__ref":"Paragraph:bc8a981a2f25_48"},{"__ref":"Paragraph:bc8a981a2f25_49"},{"__ref":"Paragraph:bc8a981a2f25_50"},{"__ref":"Paragraph:bc8a981a2f25_51"},{"__ref":"Paragraph:bc8a981a2f25_52"},{"__ref":"Paragraph:bc8a981a2f25_53"},{"__ref":"Paragraph:bc8a981a2f25_54"},{"__ref":"Paragraph:bc8a981a2f25_55"},{"__ref":"Paragraph:bc8a981a2f25_56"},{"__ref":"Paragraph:bc8a981a2f25_57"},{"__ref":"Paragraph:bc8a981a2f25_58"},{"__ref":"Paragraph:bc8a981a2f25_59"},{"__ref":"Paragraph:bc8a981a2f25_60"},{"__ref":"Paragraph:bc8a981a2f25_61"},{"__ref":"Paragraph:bc8a981a2f25_62"},{"__ref":"Paragraph:bc8a981a2f25_63"},{"__ref":"Paragraph:bc8a981a2f25_64"},{"__ref":"Paragraph:bc8a981a2f25_65"},{"__ref":"Paragraph:bc8a981a2f25_66"},{"__ref":"Paragraph:bc8a981a2f25_67"},{"__ref":"Paragraph:bc8a981a2f25_68"},{"__ref":"Paragraph:bc8a981a2f25_69"},{"__ref":"Paragraph:bc8a981a2f25_70"},{"__ref":"Paragraph:bc8a981a2f25_71"},{"__ref":"Paragraph:bc8a981a2f25_72"},{"__ref":"Paragraph:bc8a981a2f25_73"},{"__ref":"Paragraph:bc8a981a2f25_74"},{"__ref":"Paragraph:bc8a981a2f25_75"},{"__ref":"Paragraph:bc8a981a2f25_76"},{"__ref":"Paragraph:bc8a981a2f25_77"},{"__ref":"Paragraph:bc8a981a2f25_78"},{"__ref":"Paragraph:bc8a981a2f25_79"},{"__ref":"Paragraph:bc8a981a2f25_80"},{"__ref":"Paragraph:bc8a981a2f25_81"},{"__ref":"Paragraph:bc8a981a2f25_82"},{"__ref":"Paragraph:bc8a981a2f25_83"},{"__ref":"Paragraph:bc8a981a2f25_84"},{"__ref":"Paragraph:bc8a981a2f25_85"},{"__ref":"Paragraph:bc8a981a2f25_86"},{"__ref":"Paragraph:bc8a981a2f25_87"},{"__ref":"Paragraph:bc8a981a2f25_88"},{"__ref":"Paragraph:bc8a981a2f25_89"},{"__ref":"Paragraph:bc8a981a2f25_90"},{"__ref":"Paragraph:bc8a981a2f25_91"},{"__ref":"Paragraph:bc8a981a2f25_92"},{"__ref":"Paragraph:bc8a981a2f25_93"},{"__ref":"Paragraph:bc8a981a2f25_94"},{"__ref":"Paragraph:bc8a981a2f25_95"},{"__ref":"Paragraph:bc8a981a2f25_96"},{"__ref":"Paragraph:bc8a981a2f25_97"},{"__ref":"Paragraph:bc8a981a2f25_98"},{"__ref":"Paragraph:bc8a981a2f25_99"},{"__ref":"Paragraph:bc8a981a2f25_100"},{"__ref":"Paragraph:bc8a981a2f25_101"},{"__ref":"Paragraph:bc8a981a2f25_102"},{"__ref":"Paragraph:bc8a981a2f25_103"},{"__ref":"Paragraph:bc8a981a2f25_104"},{"__ref":"Paragraph:bc8a981a2f25_105"},{"__ref":"Paragraph:bc8a981a2f25_106"},{"__ref":"Paragraph:bc8a981a2f25_107"},{"__ref":"Paragraph:bc8a981a2f25_108"},{"__ref":"Paragraph:bc8a981a2f25_109"},{"__ref":"Paragraph:bc8a981a2f25_110"},{"__ref":"Paragraph:bc8a981a2f25_111"},{"__ref":"Paragraph:bc8a981a2f25_112"},{"__ref":"Paragraph:bc8a981a2f25_113"},{"__ref":"Paragraph:bc8a981a2f25_114"},{"__ref":"Paragraph:bc8a981a2f25_115"},{"__ref":"Paragraph:bc8a981a2f25_116"},{"__ref":"Paragraph:bc8a981a2f25_117"},{"__ref":"Paragraph:bc8a981a2f25_118"},{"__ref":"Paragraph:bc8a981a2f25_119"},{"__ref":"Paragraph:bc8a981a2f25_120"},{"__ref":"Paragraph:bc8a981a2f25_121"},{"__ref":"Paragraph:bc8a981a2f25_122"},{"__ref":"Paragraph:bc8a981a2f25_123"},{"__ref":"Paragraph:bc8a981a2f25_124"},{"__ref":"Paragraph:bc8a981a2f25_125"},{"__ref":"Paragraph:bc8a981a2f25_126"},{"__ref":"Paragraph:bc8a981a2f25_127"},{"__ref":"Paragraph:bc8a981a2f25_128"},{"__ref":"Paragraph:bc8a981a2f25_129"},{"__ref":"Paragraph:bc8a981a2f25_130"},{"__ref":"Paragraph:bc8a981a2f25_131"},{"__ref":"Paragraph:bc8a981a2f25_132"},{"__ref":"Paragraph:bc8a981a2f25_133"},{"__ref":"Paragraph:bc8a981a2f25_134"},{"__ref":"Paragraph:bc8a981a2f25_135"},{"__ref":"Paragraph:bc8a981a2f25_136"},{"__ref":"Paragraph:bc8a981a2f25_137"},{"__ref":"Paragraph:bc8a981a2f25_138"},{"__ref":"Paragraph:bc8a981a2f25_139"},{"__ref":"Paragraph:bc8a981a2f25_140"},{"__ref":"Paragraph:bc8a981a2f25_141"},{"__ref":"Paragraph:bc8a981a2f25_142"},{"__ref":"Paragraph:bc8a981a2f25_143"},{"__ref":"Paragraph:bc8a981a2f25_144"},{"__ref":"Paragraph:bc8a981a2f25_145"},{"__ref":"Paragraph:bc8a981a2f25_146"},{"__ref":"Paragraph:bc8a981a2f25_147"},{"__ref":"Paragraph:bc8a981a2f25_148"},{"__ref":"Paragraph:bc8a981a2f25_149"},{"__ref":"Paragraph:bc8a981a2f25_150"},{"__ref":"Paragraph:bc8a981a2f25_151"},{"__ref":"Paragraph:bc8a981a2f25_152"},{"__ref":"Paragraph:bc8a981a2f25_153"},{"__ref":"Paragraph:bc8a981a2f25_154"},{"__ref":"Paragraph:bc8a981a2f25_155"},{"__ref":"Paragraph:bc8a981a2f25_156"},{"__ref":"Paragraph:bc8a981a2f25_157"},{"__ref":"Paragraph:bc8a981a2f25_158"},{"__ref":"Paragraph:bc8a981a2f25_159"},{"__ref":"Paragraph:bc8a981a2f25_160"},{"__ref":"Paragraph:bc8a981a2f25_161"},{"__ref":"Paragraph:bc8a981a2f25_162"},{"__ref":"Paragraph:bc8a981a2f25_163"},{"__ref":"Paragraph:bc8a981a2f25_164"},{"__ref":"Paragraph:bc8a981a2f25_165"},{"__ref":"Paragraph:bc8a981a2f25_166"},{"__ref":"Paragraph:bc8a981a2f25_167"},{"__ref":"Paragraph:bc8a981a2f25_168"},{"__ref":"Paragraph:bc8a981a2f25_169"},{"__ref":"Paragraph:bc8a981a2f25_170"},{"__ref":"Paragraph:bc8a981a2f25_171"},{"__ref":"Paragraph:bc8a981a2f25_172"},{"__ref":"Paragraph:bc8a981a2f25_173"},{"__ref":"Paragraph:bc8a981a2f25_174"},{"__ref":"Paragraph:bc8a981a2f25_175"},{"__ref":"Paragraph:bc8a981a2f25_176"},{"__ref":"Paragraph:bc8a981a2f25_177"},{"__ref":"Paragraph:bc8a981a2f25_178"},{"__ref":"Paragraph:bc8a981a2f25_179"},{"__ref":"Paragraph:bc8a981a2f25_180"},{"__ref":"Paragraph:bc8a981a2f25_181"},{"__ref":"Paragraph:bc8a981a2f25_182"},{"__ref":"Paragraph:bc8a981a2f25_183"},{"__ref":"Paragraph:bc8a981a2f25_184"},{"__ref":"Paragraph:bc8a981a2f25_185"},{"__ref":"Paragraph:bc8a981a2f25_186"},{"__ref":"Paragraph:bc8a981a2f25_187"},{"__ref":"Paragraph:bc8a981a2f25_188"},{"__ref":"Paragraph:bc8a981a2f25_189"},{"__ref":"Paragraph:bc8a981a2f25_190"},{"__ref":"Paragraph:bc8a981a2f25_191"},{"__ref":"Paragraph:bc8a981a2f25_192"},{"__ref":"Paragraph:bc8a981a2f25_193"},{"__ref":"Paragraph:bc8a981a2f25_194"},{"__ref":"Paragraph:bc8a981a2f25_195"},{"__ref":"Paragraph:bc8a981a2f25_196"},{"__ref":"Paragraph:bc8a981a2f25_197"},{"__ref":"Paragraph:bc8a981a2f25_198"},{"__ref":"Paragraph:bc8a981a2f25_199"},{"__ref":"Paragraph:bc8a981a2f25_200"},{"__ref":"Paragraph:bc8a981a2f25_201"},{"__ref":"Paragraph:bc8a981a2f25_202"},{"__ref":"Paragraph:bc8a981a2f25_203"},{"__ref":"Paragraph:bc8a981a2f25_204"},{"__ref":"Paragraph:bc8a981a2f25_205"},{"__ref":"Paragraph:bc8a981a2f25_206"},{"__ref":"Paragraph:bc8a981a2f25_207"},{"__ref":"Paragraph:bc8a981a2f25_208"},{"__ref":"Paragraph:bc8a981a2f25_209"},{"__ref":"Paragraph:bc8a981a2f25_210"},{"__ref":"Paragraph:bc8a981a2f25_211"},{"__ref":"Paragraph:bc8a981a2f25_212"},{"__ref":"Paragraph:bc8a981a2f25_213"},{"__ref":"Paragraph:bc8a981a2f25_214"},{"__ref":"Paragraph:bc8a981a2f25_215"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:cc3e73266fd9"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"machine-learning"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"bc8a981a2f25","postResponses":{"__typename":"PostResponses","count":4},"responseDistribution":"NOT_DISTRIBUTED","clapCount":142,"title":"Creating a TensorFlow CNN in C++ (Part 2)","isSeries":false,"sequence":null,"uniqueSlug":"creating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada","socialTitle":"","socialDek":"","canonicalUrl":"https:\u002F\u002Fmedium.com\u002Fdata-science\u002Fcreating-a-tensorflow-cnn-in-c-part-2-eea0de9dcada","metaDescription":"","latestPublishedAt":1560205229810,"readingTime":12.390880503144654,"previewContent":{"__typename":"PreviewContent","subtitle":"In this post I’ll show how to create, train and test a Convolutional Neural Network using the TensorFlow C++ API"},"previewImage":{"__ref":"ImageMetadata:1*R6INLxmJU9ALePGUAYuMNQ.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1560198643474,"updatedAt":1639133303065,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:eea0de9dcada-viewerId:lo_e1bd0aaae880"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:machine-learning"},{"__ref":"Tag:cplusplus"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":3182,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/manifest.0e7d5ddc.js.pobrane"></script><script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/4485.c0eedc38.js.pobrane"></script><script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/main.db8880d9.js.pobrane"></script><script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/instrumentation.6b20dedd.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/reporting.ff22a7a5.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/8813.184613be.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/5049.d1ead72d.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/589.8ba7d406.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/4237.d8c83b38.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3241.027aa7b0.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3326.69979fdb.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2705.5e7561a5.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/9977.df0988bc.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/8640.9bcaa8fd.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3191.8c3974b0.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/6372.f6f824e0.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/7381.21ce652a.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/5429.581e8802.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/5522.32d53933.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/5660.de7ae834.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/4929.33b943f1.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/745.bb52d8e0.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/6834.d8976f5b.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/7979.9bc9ec8a.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/7975.a122a8cf.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3877.acc46b63.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/9256.5359e573.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/144.8e4a0ead.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3666.55c1da33.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1922.40f9cefd.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/1069.66a4ec8b.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3523.1fe5b47b.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/5659.c1f480ff.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/PostPage.MainContent.684ea13c.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2698.a5c8f865.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/3974.f4b6219d.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/2527.2da08924.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/PostResponsesContent.488f852b.chunk.js.pobrane"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/responses.editor.d1ca1cf7.chunk.js.pobrane"></script><script>window.main();</script><script defer="" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;95b70706aaf4ecbf&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.6.2&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<script src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/client" async=""></script><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-py3unqi9bd2h" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/anchor.html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./Creating a TensorFlow CNN in C++ (Part 2) _ by Benny Friedman _ TDS Archive _ Medium_files/saved_resource(1).html"></iframe></div></body></html>